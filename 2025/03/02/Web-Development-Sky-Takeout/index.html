<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Web Development -- Sky Takeout | yl's blog</title><meta name="author" content="yl"><meta name="copyright" content="yl"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Project oriendted way to learn advanced web development.">
<meta property="og:type" content="article">
<meta property="og:title" content="Web Development -- Sky Takeout">
<meta property="og:url" content="https://futureyl3.github.io/2025/03/02/Web-Development-Sky-Takeout/">
<meta property="og:site_name" content="yl&#39;s blog">
<meta property="og:description" content="Project oriendted way to learn advanced web development.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://futureyl3.github.io/img/kano.JPG">
<meta property="article:published_time" content="2025-03-02T10:51:57.000Z">
<meta property="article:modified_time" content="2025-03-02T10:51:57.000Z">
<meta property="article:author" content="yl">
<meta property="article:tag" content="Web Development">
<meta property="article:tag" content="Vue">
<meta property="article:tag" content="Spring Boot">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://futureyl3.github.io/img/kano.JPG"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Web Development -- Sky Takeout",
  "url": "https://futureyl3.github.io/2025/03/02/Web-Development-Sky-Takeout/",
  "image": "https://futureyl3.github.io/img/kano.JPG",
  "datePublished": "2025-03-02T10:51:57.000Z",
  "dateModified": "2025-03-02T10:51:57.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "yl",
      "url": "https://futureyl3.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://futureyl3.github.io/2025/03/02/Web-Development-Sky-Takeout/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":true,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: false,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Web Development -- Sky Takeout',
  isHighlightShrink: undefined,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/kano.JPG" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: linear-gradient(to right, rgb(198, 255, 221), rgb(251, 215, 134), rgb(247, 121, 125));"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">yl's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Web Development -- Sky Takeout</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Web Development -- Sky Takeout</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-03-02T10:51:57.000Z" title="Created 2025-03-02 18:51:57">2025-03-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-03-02T10:51:57.000Z" title="Updated 2025-03-02 18:51:57">2025-03-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web-Development-Projects/">Web Development Projects</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">12.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>50mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1>苍穹外卖</h1>
<h2 id="基础数据模块">基础数据模块</h2>
<h3 id="项目概述">项目概述</h3>
<h4 id="软件开发整体介绍">软件开发整体介绍</h4>
<h5 id="软件开发流程（从上至下）">软件开发流程（从上至下）</h5>
<ol>
<li>需求分析：需求规格说明书、产品原型</li>
<li>设计：UI设计、数据库设计、接口设计</li>
<li>编码：项目代码、单元测试</li>
<li>测试：测试用例、测试报告</li>
<li>上线运维：软件环境安装、配置</li>
</ol>
<h5 id="角色分工">角色分工</h5>
<ul>
<li>项目经理：对整个项目负责，<strong>任务分配、把控进度</strong></li>
<li>产品经理：进行<strong>需求调研</strong>，输出需求调研文档、产品原型等</li>
<li>UI设计师：根据产品原型输出<strong>界面效果图</strong></li>
<li>架构师：项目整体<strong>架构设计、技术选型</strong>等</li>
<li>开发工程师：代码实现</li>
<li>测试工程师：编写测试用例、输出测试报告</li>
<li>运维工程师：软件环境搭建、项目上线</li>
</ul>
<h5 id="软件环境">软件环境</h5>
<ul>
<li>开发环境（development）：开发人员在开发阶段使用的环境，一般外部用户无法访问</li>
<li>测试环境（tesing）：专门给测试人员使用的环境，用于测试项目，一般外部用户无法访问</li>
<li>生产环境（production）：即线上环境，正式提供对外服务的环境</li>
</ul>
<h4 id="苍穹外卖项目介绍">苍穹外卖项目介绍</h4>
<h5 id="项目介绍">项目介绍</h5>
<p>**定位：**专门为餐饮企业（餐厅、饭店）定制的一款软件产品</p>
<p>功能架构：体现项目中的业务功能模块</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%8A%9F%E8%83%BD%E6%9E%B6%E6%9E%84.png" class="">
<h5 id="产品原型">产品原型</h5>
<p><strong>用于展示项目的业务功能，一般由产品经理进行设计</strong></p>
<p>一般为一组 HTML 网页，内含页面原型和需求介绍以及设计要求</p>
<h5 id="技术选型">技术选型</h5>
<p><strong>展示项目中使用到的技术框架和中间件等</strong></p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B.png" class="">
<h6 id="用户层（主要是前端技术）：">用户层（主要是前端技术）：</h6>
<ul>
<li>Node.js</li>
<li>Vue.js</li>
<li>ElementUI</li>
<li>微信小程序</li>
<li>Apache Echarts</li>
</ul>
<h6 id="网关层：Nginx">网关层：Nginx</h6>
<h6 id="应用层（主要是后端技术）：">应用层（主要是后端技术）：</h6>
<ul>
<li>Spring Boot</li>
<li>Spring MVC</li>
<li>Spring Task（订单计时）</li>
<li>HttpClient（发送 HTTP 请求）</li>
<li>Spring Cache（缓存框架）</li>
<li>JWT</li>
<li>阿里云OSS</li>
<li>Swagger</li>
<li>POI（操作 Excel 表格）</li>
<li>WebSocket（实现催单，来单提醒。一种网络协议）</li>
</ul>
<h6 id="数据层：">数据层：</h6>
<ul>
<li>MySQL</li>
<li>Redis（数据库缓存中间件）</li>
<li>MyBatis</li>
<li>PageHelper</li>
<li>Spring Data Redis（简化操作 Redis 的一组 API）</li>
</ul>
<h6 id="工具：">工具：</h6>
<ul>
<li>Git</li>
<li>JUnit</li>
<li>Maven</li>
<li>Postman</li>
</ul>
<h3 id="环境搭建">环境搭建</h3>
<h4 id="开发环境搭建">开发环境搭建</h4>
<h5 id="前端环境搭建">前端环境搭建</h5>
<h6 id="整体结构">整体结构</h6>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%89%8D%E7%AB%AF%E6%95%B4%E4%BD%93%E7%BB%93%E6%9E%84.png" class="">
<ul>
<li>
<p>双击前端环境 <code>Nginx</code> 文件夹中的 <code>nginx.exe</code> 启动 nginx 服务，访问端口号为 <code>80</code></p>
</li>
<li>
<p>前端项目已经部署到了 <code>Nginx</code> 文件夹中，通过 <code>localhost:80</code> 即可访问到前端项目</p>
</li>
</ul>
<h5 id="后端环境搭建">后端环境搭建</h5>
<p>后端工程基于 <strong>Maven</strong> 进行项目构建，并且进行<strong>分模块</strong>开发</p>
<h6 id="项目结构：">项目结构：</h6>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.png" class="">
<h6 id="项目各模块说明：">项目各模块说明：</h6>
<table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>sky-take-out</td>
<td>Maven 父工程，统一管理依赖版本，聚合其他子模块</td>
</tr>
<tr>
<td>sky-common</td>
<td>子模块，存放公共类，例如：工具类、常量类、异常类等</td>
</tr>
<tr>
<td>sky-pojo</td>
<td>子模块，存放实体类、VO、DTO 等</td>
</tr>
<tr>
<td>sky-server</td>
<td>子模块，后端服务，存放配置文件、Controller、Service、Mapper 等</td>
</tr>
</tbody>
</table>
<h6 id="sky-common-模块目录结构：">sky-common 模块目录结构：</h6>
<img src="/2025/03/02/Web-Development-Sky-Takeout/sky-common.png" class="">
<p>存放公共类，可以供其他模块使用</p>
<h6 id="sky-pojo-模块目录结构：">sky-pojo 模块目录结构：</h6>
<img src="/2025/03/02/Web-Development-Sky-Takeout/sky-pojo.png" class="">
<p>存放 entity、DTO、VO</p>
<ul>
<li>
<p>名词解释：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Entity</td>
<td>实体，通常和数据库中的表对应</td>
</tr>
<tr>
<td>DTO</td>
<td>数据传输对象，通常用于程序中各层之间传递数据</td>
</tr>
<tr>
<td>VO</td>
<td>视图对象，为前端展示数据提供的对象</td>
</tr>
<tr>
<td>POJO</td>
<td>普通 Java 对象，只有属性和对应的 getter 和 setter</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h6 id="sky-server-模块目录结构：">sky-server 模块目录结构：</h6>
<img src="/2025/03/02/Web-Development-Sky-Takeout/sky-server.png" class="">
<p>存放配置文件、配置类、拦截器、controller、service、mapper、启动类等</p>
<h6 id="使用-Git-进行版本控制">使用 Git 进行版本控制</h6>
<ol>
<li>创建本地仓库</li>
<li>提交本地仓库</li>
<li>推送到远程仓库</li>
</ol>
<h6 id="数据库环境搭建">数据库环境搭建</h6>
<p>执行提供的 sql 脚本</p>
<h6 id="前后端联调">前后端联调</h6>
<blockquote>
<p><strong>nginx 反向代理：</strong></p>
<p>nginx 反向代理，就是将前端发送的动态请求由 nginx 转发到后端服务器</p>

<p>nginx 反向代理的好处：</p>
<ul>
<li>
<p>提高访问速度</p>
</li>
<li>
<p>进行负载均衡</p>
<blockquote>
<p>所谓负载均衡，就是把大量的请求按照我们指定的方式均衡地分配给集群中的每台服务器</p>
</blockquote>
</li>
<li>
<p>保证后端服务安全（外界无法直接访问后端服务，不对外开放，只能由公司内网请求）</p>
</li>
</ul>
<p><strong>反向代理配置方式：</strong></p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">	<span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">	<span class="attribute">server_name</span> localhost;</span><br><span class="line"></span><br><span class="line">	<span class="section">location</span> /api/ &#123; <span class="comment"># 当请求路径中含有/api/时，将/api/前面的部分改为http://localhost:8080/admin/，后面的部分拼在其后</span></span><br><span class="line">		<span class="attribute">proxy_pass</span> http://localhost:8080/admin/; <span class="comment"># 反向代理</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>负载均衡配置方式：</strong></p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">upstream</span> webservers &#123; <span class="comment"># 服务器集群每台服务器ip</span></span><br><span class="line">    <span class="attribute">server</span> <span class="number">192.168.100.128:8080</span>;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">192.168.100.129:8080</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> localhost;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> /api/ &#123; <span class="comment"># 具体转发给哪台主机，哪台主机转发多，哪台转发少，由负载均衡策略决定</span></span><br><span class="line">        <span class="attribute">proxy_pass</span> http://webservers/admin/; <span class="comment"># 负载均衡</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>负载均衡策略：</strong></p>
<table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>轮询</td>
<td>默认方式</td>
</tr>
<tr>
<td>weight</td>
<td>权重方式，默认为1，权重越高，被分配的客户端请求就越多</td>
</tr>
<tr>
<td>ip_hash</td>
<td>根据 ip 分配方式，这样每个访客可以固定访问一个后端服务</td>
</tr>
<tr>
<td>least_conn</td>
<td>依据最少连接方式，把请求优先分配给连接数少的后端服务</td>
</tr>
<tr>
<td>url_hash</td>
<td>根据 url 分配方式，这样相同的 url 会被分配到同一个后端服务</td>
</tr>
<tr>
<td>fair</td>
<td>依据响应时间方式，响应时间短的服务将会被优先分配</td>
</tr>
</tbody>
</table>
</blockquote>
<h5 id="完善登录功能">完善登录功能</h5>
<p>问题：员工表中的密码是明文存储，安全性太低</p>
<p>思路：</p>
<ol>
<li>
<p>将密码加密后存储，提高安全性</p>
</li>
<li>
<p>使用 MD5 加密方式对明文密码加密</p>
<blockquote>
<p>MD5（Message Digest Algorithm 5）是一种哈希函数，而不是加密算法。哈希函数是一种将任意长度的输入数据映射为固定长度散列值的算法。MD5 产生的散列值通常是128位长，通常以32个十六进制字符的形式表示。</p>
<p>MD5 算法的特点是快速且具有固定输出长度。然而，由于其设计上的一些弱点，MD5 已经被认为不安全，不建议在安全性要求较高的场景中使用。在现代加密和安全标准中，通常推荐使用更安全的哈希函数，如SHA-256（Secure Hash Algorithm 256-bit）等。</p>
</blockquote>
</li>
<li>
<p>验证时将明文加密为密文，再与数据库中已有密码比较</p>
</li>
</ol>
<p>步骤：</p>
<ol>
<li>
<p>修改数据库中明文密码，改为 MD5 加密后的密文</p>
</li>
<li>
<p>修改 Java 代码，前端提交的密码进行 MD5 加密后再跟数据库中密码比对</p>
<blockquote>
<p>Spring 框架提供了对字符串进行 MD5 加密的工具类，使用如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">password = DigestUtils.md5DigestAsHex(password.getBytes());</span><br><span class="line"><span class="keyword">if</span> (!password.equals(employee.getPassword())) &#123;</span><br><span class="line"> <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">PassWordErrorException</span>(MessageConstant.PASSWORD_ERROR);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ol>
<h4 id="导入接口文档">导入接口文档</h4>
<h5 id="前后端分离开发流程">前后端分离开发流程</h5>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B.png" class="">
<h5 id="操作步骤">操作步骤</h5>
<p>将资料中提供的项目接口导入 YApi</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E9%A1%B9%E7%9B%AE%E6%8E%A5%E5%8F%A3.png" class="">
<p>管理端共47个接口，用户端共25个接口</p>
<h4 id="Swagger">Swagger</h4>
<h5 id="介绍">介绍</h5>
<p>使用 Swagger，你只需要按照它的规范去定义接口及接口相关的信息，就可以做到生成接口文档，以及<strong>在线接口调试</strong>页面。</p>
<p>官网：[<a target="_blank" rel="noopener" href="http://swagger.io">http://swagger.io</a>](Swagger 官网)</p>
<p><strong>Knife4j</strong> 是为 Java MVC 框架集成 Swagger 生成 Api 文档的增强解决方案</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>knife4j-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="使用方式">使用方式</h5>
<ol>
<li>导入 knife4j 的 maven 坐标</li>
<li>在配置类中加入 knife4j 相关配置</li>
<li>设置静态资源映射，否则接口文档页面无法访问</li>
</ol>
<blockquote>
<p>Swagger 和 YApi</p>
<ul>
<li>YApi 是设计阶段使用的工具，用于管理和维护接口</li>
<li>Swagger 是开发阶段使用的框架，帮助后端开发人员做后端的接口测试</li>
<li>YApi 和 Swagger 的侧重点不同，不能说谁替代了谁，在项目开发中两者都是必要的</li>
</ul>
</blockquote>
<h5 id="常用注解">常用注解</h5>
<p><code>@Api</code>：对 controller 类的说明</p>
<p><code>@ApiModel</code>：对 pojo 类的说明</p>
<p><code>@ApiModelProperty</code> ：对 pojo 类的属性的说明</p>
<p><code>@ApiOperation</code>：对方法用途、作用等的说明</p>
<h3 id="员工管理">员工管理</h3>
<h4 id="新增员工">新增员工</h4>
<h5 id="需求分析">需求分析</h5>
<ul>
<li>
<p>分析传递参数限制</p>
</li>
<li>
<p>设计接口</p>
<blockquote>
<p>为方便后端区分，管理端发出的请求，统一使用 /admin 作为前缀，用户端发出的请求，统一使用 /user 作为前缀</p>
</blockquote>
</li>
<li>
<p>查看对应数据库，来明晰数据约束</p>
</li>
</ul>
<h5 id="代码开发">代码开发</h5>
<p>根据新增员工接口设计对应的 DTO</p>
<blockquote>
<p>注意：当前端提交的数据和实体类中对应的属性差别比较大时，建议使用 DTO 来封装数据</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeDTO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String idNumber;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="功能测试">功能测试</h5>
<h5 id="代码完善">代码完善</h5>
<ul>
<li>
<p>录入的用户名已存在，抛出异常后没有处理</p>
<p>用全局异常处理类来捕获相应异常，并返回给前端异常信息。</p>
</li>
<li>
<p>新增员工时，创建人 ID 和修改人 ID 设置为了固定值</p>
<ol>
<li>从请求头中拿到 token，读取出 token 中的员工 id</li>
<li>第一步操作是在 JwtTokenAdminInterceptor 类中完成的，如何将拿到的员工 id 传给 service 层的 save 方法？</li>
<li>使用 ThreadLocal 类，由于客户端的一次请求会在同一个线程中进行，所以我们可以先把员工 id 存到 ThreadLocal 类中，然后在之后需要的时候再取出来用</li>
</ol>
<img src="/2025/03/02/Web-Development-Sky-Takeout/ThreadLocal.png" class="">
</li>
</ul>
<h4 id="员工分页查询">员工分页查询</h4>
<p>使用 EmployeePageQueryDTO 接收前端参数，返回 Result<PageResult> 对象，泛型中含有查询的总条数和该页的员工列表。</p>
<p>问题：查询返回的日期格式不符合预期</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%BC%82%E5%B8%B8%E6%A0%BC%E5%BC%8F%E6%97%A5%E6%9C%9F.png" class="">
<p>解决方法：</p>
<ul>
<li>
<p>在属性上加入注解，对日期进行格式化</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line"><span class="keyword">private</span> LocalDateTime createTime;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>在 WebMvcConfiguration 中扩展 Spring MVC 的消息转换器，统一对日期类型进行格式化处理</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">extendMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> &#123;</span><br><span class="line">    <span class="comment">// 创建一个消息转换器对象</span></span><br><span class="line">    <span class="type">MappingJackson2HttpMessageConverter</span> <span class="variable">converter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MappingJackson2HttpMessageConverter</span>();</span><br><span class="line">    <span class="comment">// 需要为消息转换器设置一个对象转换器，对象转换器可以将Java对象序列化为json对象</span></span><br><span class="line">    converter.setObjectMapper(<span class="keyword">new</span> <span class="title class_">JacksonObjectMapper</span>());</span><br><span class="line">    <span class="comment">// 将自己的消息转换器加入到容器中，并设置优先级为0（第一）</span></span><br><span class="line">    converters.add(<span class="number">0</span>, converter);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="启用禁用员工账号">启用禁用员工账号</h4>
<p>无新增技术</p>
<h4 id="编辑员工">编辑员工</h4>
<p>无新增技术</p>
<h3 id="分类管理">分类管理</h3>
<h4 id="导入分类模块功能代码">导入分类模块功能代码</h4>
<h3 id="菜品管理">菜品管理</h3>
<h4 id="公共字段自动填充">公共字段自动填充</h4>
<p>**问题：**每次增加菜品、分类等都要填充创建时间、修改时间、创建人id和修改人id，代码冗余</p>
<p><strong>解决思路：</strong></p>
<ol>
<li>
<p>明确操作时机</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%85%AC%E5%85%B1%E5%AD%97%E6%AE%B5%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85-%E6%98%8E%E7%A1%AE%E6%93%8D%E4%BD%9C%E6%97%B6%E6%9C%BA.png" class="">
</li>
<li>
<p>使用 AOP 来为公共字段填充值，具体做法是：</p>
<ol>
<li>自定义注解 AutoFill，用于表示需要进行公共字段自动填充的方法</li>
<li>自定义切面类 AutoFillAspect，统一拦截加入了 AutoFill 注解的方法，通过反射为公共字段赋值</li>
<li>在对应方法上加入注解</li>
</ol>
</li>
</ol>
<p>技术点：枚举、注解、AOP、反射</p>
<p><strong>代码实现：</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AutoFillAspect</span> &#123;</span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.sky.service.*.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">servicePointCut</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.sky.mapper.*.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mapperPointCut</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;(servicePointCut() || mapperPointCut()) &amp;&amp; @annotation(com.sky.annotation.AutoFill)&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">autoFillAspect</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Before(&quot;autoFillAspect()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">autoFill</span><span class="params">(JoinPoint joinPoint)</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException &#123;</span><br><span class="line">        <span class="comment">// 日志记录</span></span><br><span class="line">        log.info(<span class="string">&quot;进行公共字段自动填充&quot;</span>);</span><br><span class="line">        <span class="comment">// 拿到操作类型</span></span><br><span class="line">        <span class="type">MethodSignature</span> <span class="variable">signature</span> <span class="operator">=</span> (MethodSignature) joinPoint.getSignature();</span><br><span class="line">        <span class="type">AutoFill</span> <span class="variable">annotation</span> <span class="operator">=</span> (AutoFill) signature.getMethod().getAnnotation(AutoFill.class);</span><br><span class="line">        <span class="type">OperationType</span> <span class="variable">type</span> <span class="operator">=</span> annotation.value();</span><br><span class="line">        <span class="comment">// 拿到方法参数</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">entity</span> <span class="operator">=</span> joinPoint.getArgs()[<span class="number">0</span>];</span><br><span class="line">        <span class="comment">// 数据准备</span></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">now</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line">        <span class="type">Long</span> <span class="variable">id</span> <span class="operator">=</span> BaseContext.getCurrentId();</span><br><span class="line">        <span class="comment">// 通过反射来设置值</span></span><br><span class="line">        <span class="keyword">if</span> (type == OperationType.INSERT) &#123;</span><br><span class="line">            <span class="type">Method</span> <span class="variable">setCreateTime</span> <span class="operator">=</span> entity.getClass().getMethod(AutoFillConstant.SET_CREATE_TIME, LocalDateTime.class);</span><br><span class="line">            <span class="type">Method</span> <span class="variable">setUpdateTime</span> <span class="operator">=</span> entity.getClass().getMethod(AutoFillConstant.SET_UPDATE_TIME, LocalDateTime.class);</span><br><span class="line">            <span class="type">Method</span> <span class="variable">setCreateUser</span> <span class="operator">=</span> entity.getClass().getMethod(AutoFillConstant.SET_CREATE_USER, Long.class);</span><br><span class="line">            <span class="type">Method</span> <span class="variable">setUpdateUser</span> <span class="operator">=</span> entity.getClass().getMethod(AutoFillConstant.SET_UPDATE_USER, Long.class);</span><br><span class="line"></span><br><span class="line">            setCreateTime.invoke(entity, now);</span><br><span class="line">            setUpdateTime.invoke(entity, now);</span><br><span class="line">            setCreateUser.invoke(entity, id);</span><br><span class="line">            setUpdateUser.invoke(entity, id);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == OperationType.UPDATE) &#123;</span><br><span class="line">            <span class="type">Method</span> <span class="variable">setUpdateTime</span> <span class="operator">=</span> entity.getClass().getMethod(AutoFillConstant.SET_UPDATE_TIME, LocalDateTime.class);</span><br><span class="line">            <span class="type">Method</span> <span class="variable">setUpdateUser</span> <span class="operator">=</span> entity.getClass().getMethod(AutoFillConstant.SET_UPDATE_USER, Long.class);</span><br><span class="line"></span><br><span class="line">            setUpdateTime.invoke(entity, now);</span><br><span class="line">            setUpdateUser.invoke(entity, id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="新增菜品">新增菜品</h4>
<ol>
<li>使用 DTO 接收前端传参</li>
<li>公共字段自动填充</li>
<li>完成新增菜品</li>
<li>拿到返回的新增菜品的id</li>
<li>新增口味</li>
</ol>
<h4 id="菜品分页查询">菜品分页查询</h4>
<h4 id="删除菜品">删除菜品</h4>
<p>业务规则：</p>
<ul>
<li>可以一次删除一个菜品，也可以批量删除菜品</li>
<li>起售中的菜品不能删除</li>
<li>被套餐关联的菜品不能删除</li>
<li>删除菜品后，关联的口味数据也需要删除掉</li>
</ul>
<p><strong>重要</strong></p>
<p>前端请求路径为 <code>..?ids=1,2,3</code></p>
<p>我们如果想要用 List 来接收这些 id，就需要在参数前面加上注解 <code>@RequestParam</code>，这样，springMVC 会帮我们把形如 <code>1,2,3</code> 的数据格式以列表的方式封装到我们的 List 中</p>
<h4 id="修改菜品">修改菜品</h4>
<p>先修改菜品信息，再统一删除关联口味信息，最后添加上修改后的口味信息</p>
<h3 id="套餐管理实战">套餐管理实战</h3>
<h4 id="新增套餐">新增套餐</h4>
<p>分析需求：</p>
<ul>
<li>套餐状态默认为停售</li>
<li>一个套餐可以对应多个菜品</li>
<li>一个菜品可以对应多个套餐</li>
<li>新增后要维护 setmeal_dish 表</li>
<li>categoryId 即为套餐所属分类的 id</li>
</ul>
<h4 id="分页查询套餐">分页查询套餐</h4>
<p>分析需求：</p>
<ul>
<li>用 SetmealVO 来包装数据</li>
<li>返回 PageResult 对象</li>
<li>根据 categoryId 查出分类名，使用多表查询</li>
<li>分类被禁用后，前台不展示</li>
</ul>
<p><strong>使用别名进行多表查询时，select 后面跟的字段名也一定要起与实体类对应的别名，否则查询结果无法映射到实体类的属性上</strong></p>
<h4 id="删除套餐">删除套餐</h4>
<p>分析需求：</p>
<ul>
<li>批量删除，使用 ids 接收前端传参，用 @RequestParam 让 SpringMVC 自动封装到 List 中</li>
<li>起售的套餐不能删除</li>
<li>能够删除的套餐，关联的菜品也要一并删除</li>
<li>包含起售的套餐，则最后抛异常，并不予删除</li>
</ul>
<h4 id="修改套餐">修改套餐</h4>
<p>分析需求：</p>
<ul>
<li>实现根据 id 查询用于页面回显</li>
<li>用 setmealDTO 接收前端传参</li>
<li>自动填充公共字段</li>
<li>先统一删除关联菜品再添加修改后的菜品</li>
</ul>
<h4 id="起售停售套餐">起售停售套餐</h4>
<p>分析需求：</p>
<ul>
<li>套餐内有停售菜品，则套餐无法起售</li>
</ul>
<h3 id="Redis">Redis</h3>
<h4 id="Redis-入门">Redis 入门</h4>
<h5 id="Redis-简介">Redis 简介</h5>
<p>Redis 是一个基于内存的 key-value 结构数据库</p>
<ul>
<li>基于内存存储，读写性能高</li>
<li>适合存储热点数据（热点商品、咨询、新闻，在某一时间段会被用户大量访问的数据）</li>
<li>企业应用广泛</li>
</ul>
<p>官网：<a target="_blank" rel="noopener" href="https://redis.io">https://redis.io</a></p>
<p>中文网：<a target="_blank" rel="noopener" href="https://www.redis.net.cn/">https://www.redis.net.cn/</a></p>
<h5 id="Redis-下载与安装">Redis 下载与安装</h5>
<p>Windows 版本下的 Redis 目录结构</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/Redis-win%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84.png" class="">
<h5 id="Redis-服务启动与停止">Redis 服务启动与停止</h5>
<p>服务启动：<code>redis-server</code></p>
<p>服务停止：<code>ctrl+c or command+c</code></p>
<p>客户端登录：<code>redis-cli -h ipaddress -p port</code></p>
<p>客户端退出：<code>exit</code></p>
<p>Redis 默认登录没有密码，为提高安全性，在配置文件中配置登录密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 找到这一行配置项</span><br><span class="line">requirepass yourPassword</span><br></pre></td></tr></table></figure>
<p><strong>Redis 中没有用户这一概念</strong></p>
<h4 id="Redis-数据类型">Redis 数据类型</h4>
<h5 id="5-种常用数据类型介绍">5 种常用数据类型介绍</h5>
<p>Redis 使用键值对 key-value 结构来存储数据，其中 key 规定是字符串类型，而 value 有 5 种常用类型：</p>
<ul>
<li>字符串 string</li>
<li>哈希 hash （适合存储对象）</li>
<li>列表 list</li>
<li>集合 set</li>
<li>有序集合 sorted set / zet</li>
</ul>
<h5 id="各种数据类型的特点">各种数据类型的特点</h5>
<img src="/2025/03/02/Web-Development-Sky-Takeout/redis%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E7%89%B9%E7%82%B9.png" class="">
<h4 id="Redis-常用命令">Redis 常用命令</h4>
<p>==Redis 命令不区分大小写==</p>
<h5 id="字符串操作命令">字符串操作命令</h5>
<table>
<thead>
<tr>
<th>命令</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SET key value</code></td>
<td>设置指定 key 的value</td>
</tr>
<tr>
<td><code>GET key</code></td>
<td>获取指定 key 的 value</td>
</tr>
<tr>
<td><code>SETEX key seconds value</code></td>
<td>设置指定 key 的value， 并将 key 的过期时间设为 seconds 秒</td>
</tr>
<tr>
<td><code>SETNX key value</code></td>
<td>只有当 key 不存在时设置 key 的value（防覆盖）</td>
</tr>
</tbody>
</table>
<h5 id="哈希操作命令">哈希操作命令</h5>
<p>Redis hash 是一个 string 类型的 field 和 value 的映射表，hash 特别适合用于存储对象，常用命令：</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>HSET key field value</code></td>
<td>将名为 key 的哈希表中的字段 field 的值设为 value</td>
</tr>
<tr>
<td><code>HSET key field</code></td>
<td>获取存储在哈希表 key 中的指定 field 的 value</td>
</tr>
<tr>
<td><code>HDEL key field</code></td>
<td>删除存储在哈希表 key 中的指定 field</td>
</tr>
<tr>
<td><code>HKEYS key</code></td>
<td>获取哈希表中所有 field</td>
</tr>
<tr>
<td><code>HVALS key</code></td>
<td>获取哈希表中所有 value</td>
</tr>
</tbody>
</table>
<p>哈希表的 key-value 的形象图示</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%93%88%E5%B8%8C%E8%A1%A8key-value%E5%9B%BE%E7%A4%BA.png" class="">
<h5 id="列表操作命令">列表操作命令</h5>
<p>Redis 列表是简单的<strong>字符串</strong>列表，按照插入顺序排序，常用命令：</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LPUSH key value1 [value2]</code></td>
<td>将一个或多个值插入到列表头部</td>
</tr>
<tr>
<td><code>LRANGE key start stop</code></td>
<td>获取列表指定范围内的元素（0 表示开头，-1 表示结尾）</td>
</tr>
<tr>
<td><code>RPOP key</code></td>
<td>移除并获取列表最后一个元素</td>
</tr>
<tr>
<td><code>LLEN key</code></td>
<td>获取列表长度</td>
</tr>
</tbody>
</table>
<img src="/2025/03/02/Web-Development-Sky-Takeout/redis%E5%88%97%E8%A1%A8%E5%9B%BE%E7%A4%BA.png" class="">
<h5 id="集合操作命令">集合操作命令</h5>
<p>Redis set 是 string 类型的无序集合。集合成员是唯一的，集合中不能出现重复的数据，常用命令：</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SADD key member1 [member2]</code></td>
<td>向集合 key 中添加一个或多个 member</td>
</tr>
<tr>
<td><code>SMEMBERS key</code></td>
<td>返回集合 key 中的所有 member</td>
</tr>
<tr>
<td><code>SCARD key</code></td>
<td>获取集合 key 中的 member 数量</td>
</tr>
<tr>
<td><code>SINTER key1 [key2]</code></td>
<td>返回集合 key1 [key2] 等的交集</td>
</tr>
<tr>
<td><code>SUNION key1 [key2]</code></td>
<td>返回集合 key1 [key2] 等的并集</td>
</tr>
<tr>
<td><code>SREM key member1 [member2]</code></td>
<td>删除集合 key 中的一个或多个 member</td>
</tr>
</tbody>
</table>
<img src="/2025/03/02/Web-Development-Sky-Takeout/redis%E9%9B%86%E5%90%88%E5%9B%BE%E7%A4%BA.png" class="">
<h5 id="有序集合操作命令">有序集合操作命令</h5>
<p>Redis 有序集合是 string 类型元素的集合，且不允许有重复成员。每个元素都会关联一个 double 类型的分数。常用命令：</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ZADD key score1 member1 [score2 member2]</code></td>
<td>向有序集合 key 中添加一个或多个带 score 的 member</td>
</tr>
<tr>
<td><code>ZRANGE key start stop [WITHSCORES]</code></td>
<td>通过索引区间返回有序集合 key 中指定区间内的 member （及其 score）（分数升序）</td>
</tr>
<tr>
<td><code>ZINCRBY key increment member</code></td>
<td>对有序集合 key 中对指定 member 成员的 score 加上增量 increment</td>
</tr>
<tr>
<td><code>ZREM key member [member...]</code></td>
<td>删除有序集合 key 中的一个或多个 member</td>
</tr>
</tbody>
</table>
<img src="/2025/03/02/Web-Development-Sky-Takeout/redis%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88%E5%9B%BE%E7%A4%BA.png" class="">
<h5 id="通用命令">通用命令</h5>
<p>Redis 的通用命令是不区分数据类型的，都可以使用的命令：</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>KEYS pattern</code></td>
<td>查找所有符合给定 pattern 的 key（支持通配符）</td>
</tr>
<tr>
<td><code>EXISTS key</code></td>
<td>检查给定的 key 是否存在</td>
</tr>
<tr>
<td><code>TYPE key</code></td>
<td>返回 key 所储存的值的类型</td>
</tr>
<tr>
<td><code>DEL key</code></td>
<td>当 key 存在时将 key 删除，可一次删除多个，用空格隔开 key</td>
</tr>
</tbody>
</table>
<h4 id="在-Java-中操作-Redis">在 Java 中操作 Redis</h4>
<h5 id="Redis-的-Java-客户端">Redis 的 Java 客户端</h5>
<p>Redis 的 Java 客户端很多，常用的有以下几种：</p>
<ul>
<li>Jedis（Redis 官方推荐）</li>
<li>Lettuce（性能高效）</li>
<li>Spring Data Redis</li>
</ul>
<p>Spring Data Redis 是 Spring 的一部分，对 Redis 底层开发包（包括 Jedis 和 Lettuce） 进行了高度封装。</p>
<p>在 Spring 项目中，可以使用 Spring Data Redis 来简化操作</p>
<h5 id="Spring-Data-Redis-使用方式">Spring Data Redis 使用方式</h5>
<h6 id="步骤：">步骤：</h6>
<ol>
<li>
<p>导入 Spring Data Redis 的 maven 坐标</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>配置 Redis 数据源</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">...re</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编写配置类，创建 RedisTemplate 对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedisTemplate <span class="title function_">redisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;开始创建RedisTemplate对象&quot;</span>);</span><br><span class="line">        <span class="type">RedisTemplate</span> <span class="variable">redisTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RedisTemplate</span>();</span><br><span class="line">        <span class="comment">// 设置连接工厂</span></span><br><span class="line">        redisTemplate.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        <span class="comment">// 设置序列化器</span></span><br><span class="line">        redisTemplate.setDefaultSerializer(<span class="keyword">new</span> <span class="title class_">StringRedisSerializer</span>());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> redisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>通过 RedisTemplate 对象操作 Redis</p>
<p>该对象提供了操作五种数据类型的对象</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/SpringDataRedis%E6%93%8D%E4%BD%9C%E4%BA%94%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%B9%E8%B1%A1.png" class="">
</li>
</ol>
<h6 id="字符串操作">字符串操作</h6>
<img src="/2025/03/02/Web-Development-Sky-Takeout/SpringDataRedis%E6%93%8D%E4%BD%9C%E5%AD%97%E7%AC%A6%E4%B8%B2.png" class="">
<p>set 中的多个重载方法就对应了 set setex，setIfAbsent 对应了 setnx，get 对应了 get</p>
<h6 id="哈希操作">哈希操作</h6>
<img src="/2025/03/02/Web-Development-Sky-Takeout/SpringDataRedis%E5%93%88%E5%B8%8C%E6%93%8D%E4%BD%9C.png" class="">
<p>hset 对应 put，hget 对应 get，hdel 对应 delete，hkeys 对应 keys，hvals 对应 values</p>
<h6 id="列表操作">列表操作</h6>
<img src="/2025/03/02/Web-Development-Sky-Takeout/SpringDataRedis%E5%88%97%E8%A1%A8%E6%93%8D%E4%BD%9C.png" class="">
<h6 id="集合操作">集合操作</h6>
<img src="/2025/03/02/Web-Development-Sky-Takeout/SpringDataRedis%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C.png" class="">
<h6 id="有序集合">有序集合</h6>
<img src="/2025/03/02/Web-Development-Sky-Takeout/SpringDataRedis%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C.png" class="">
<h6 id="通用命令-2">通用命令</h6>
<img src="/2025/03/02/Web-Development-Sky-Takeout/SpringDataRedis%E9%80%9A%E7%94%A8%E5%91%BD%E4%BB%A4%E6%93%8D%E4%BD%9C.png" class="">
<h2 id="点餐业务模块">点餐业务模块</h2>
<h3 id="店铺营业状态设置">店铺营业状态设置</h3>
<h4 id="需求分析和设计">需求分析和设计</h4>
<p>接口设计：</p>
<ul>
<li>设置营业状态</li>
<li>管理端查询营业状态</li>
<li>用户端查询营业状态</li>
</ul>
<p>项目约定（设置两个查询接口的原因）：</p>
<ul>
<li>管理端发出的请求，统一使用 /admin 作为前缀</li>
<li>用户端发出的请求，统一使用 /user 作为前缀</li>
</ul>
<p>营业状态数据存储方式：基于 Redis 的字符串来进行存储</p>
<h4 id="代码开发-2">代码开发</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController(&quot;adminShopController&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/shop&quot;)</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor(onConstructor_ = &#123;@Autowired&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShopController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ShopService shopService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PutMapping(&quot;/&#123;status&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">updateStatus</span><span class="params">(<span class="meta">@PathVariable</span> Integer status)</span> &#123;</span><br><span class="line">        <span class="comment">// 日志记录</span></span><br><span class="line">        log.info(<span class="string">&quot;将店铺的营业状态设置为：&#123;&#125;&quot;</span>, status);</span><br><span class="line">        <span class="comment">// 调用service完成状态更新</span></span><br><span class="line">        shopService.updateStatus(status.toString());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/status&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Integer&gt; <span class="title function_">getStatus</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 日志记录</span></span><br><span class="line">        log.info(<span class="string">&quot;管理端获取店铺状态&quot;</span>);</span><br><span class="line">        <span class="comment">// 调用service获取状态</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">status</span> <span class="operator">=</span> shopService.getStatus();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success(status);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController(&quot;userShopController&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user/shop&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor(onConstructor_ = &#123;@Autowired&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShopController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ShopService shopService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/status&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Integer&gt; <span class="title function_">getStatus</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 日志记录</span></span><br><span class="line">        log.info(<span class="string">&quot;用户端获取店铺状态&quot;</span>);</span><br><span class="line">        <span class="comment">// 调用service获取状态</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">status</span> <span class="operator">=</span> shopService.getStatus();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success(status);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor(onConstructor_ = &#123;@Autowired&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShopServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">ShopService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateStatus</span><span class="params">(String status)</span> &#123;</span><br><span class="line">        redisTemplate.opsForValue().set(StatusConstant.SHOP_STATUS, status);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getStatus</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Integer.parseInt(redisTemplate.opsForValue().get(StatusConstant.SHOP_STATUS).toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="功能测试-2">功能测试</h4>
<h3 id="微信登录">微信登录</h3>
<h4 id="HttpClient">HttpClient</h4>
<h5 id="介绍-2">介绍</h5>
<p>HttpClient 是 Apache Jakarta Common 下的子项目，可以用来提供高效的、最新的、功能丰富的支持 HTTP 协议的<strong>客户端编程工具包</strong>，并且它支持 HTTP 协议最新的版本和建议。</p>
<p>Maven 坐标</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.httpcomponents<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>httpclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.5.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>核心 API</p>
<ul>
<li>HttpClient</li>
<li>HttpClients</li>
<li>CloseableHttpClient</li>
<li>HttpGet</li>
<li>HttpPost</li>
</ul>
<p>发送请求步骤：</p>
<ul>
<li>创建 HttpClient 对象</li>
<li>创建 Http 请求对象</li>
<li>调用 HttpClient 的 execute 方法发送请求</li>
</ul>
<h5 id="入门案例">入门案例</h5>
<h6 id="GET-请求">GET 请求</h6>
<img src="/2025/03/02/Web-Development-Sky-Takeout/HttpGet.png" class="">
<h6 id="POST-请求">POST 请求</h6>
 <img src="/2025/03/02/Web-Development-Sky-Takeout/HttpPost.png" class="">
<p>记得关闭资源</p>
<h6 id="代码中提供的工具类">代码中提供的工具类</h6>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HttpClientUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span>  <span class="type">int</span> <span class="variable">TIMEOUT_MSEC</span> <span class="operator">=</span> <span class="number">5</span> * <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发送GET方式请求</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> url</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> paramMap</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">doGet</span><span class="params">(String url,Map&lt;String,String&gt; paramMap)</span>&#123;</span><br><span class="line">        <span class="comment">// 创建Httpclient对象</span></span><br><span class="line">        <span class="type">CloseableHttpClient</span> <span class="variable">httpClient</span> <span class="operator">=</span> HttpClients.createDefault();</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">CloseableHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="type">URIBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URIBuilder</span>(url);</span><br><span class="line">            <span class="keyword">if</span>(paramMap != <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">for</span> (String key : paramMap.keySet()) &#123;</span><br><span class="line">                    builder.addParameter(key,paramMap.get(key));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">URI</span> <span class="variable">uri</span> <span class="operator">=</span> builder.build();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//创建GET请求</span></span><br><span class="line">            <span class="type">HttpGet</span> <span class="variable">httpGet</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpGet</span>(uri);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//发送请求</span></span><br><span class="line">            response = httpClient.execute(httpGet);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//判断响应状态</span></span><br><span class="line">            <span class="keyword">if</span>(response.getStatusLine().getStatusCode() == <span class="number">200</span>)&#123;</span><br><span class="line">                result = EntityUtils.toString(response.getEntity(),<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                response.close();</span><br><span class="line">                httpClient.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发送POST方式请求</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> url</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> paramMap</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">doPost</span><span class="params">(String url, Map&lt;String, String&gt; paramMap)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 创建Httpclient对象</span></span><br><span class="line">        <span class="type">CloseableHttpClient</span> <span class="variable">httpClient</span> <span class="operator">=</span> HttpClients.createDefault();</span><br><span class="line">        <span class="type">CloseableHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">resultString</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 创建Http Post请求</span></span><br><span class="line">            <span class="type">HttpPost</span> <span class="variable">httpPost</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpPost</span>(url);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 创建参数列表</span></span><br><span class="line">            <span class="keyword">if</span> (paramMap != <span class="literal">null</span>) &#123;</span><br><span class="line">                List&lt;NameValuePair&gt; paramList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">                <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; param : paramMap.entrySet()) &#123;</span><br><span class="line">                    paramList.add(<span class="keyword">new</span> <span class="title class_">BasicNameValuePair</span>(param.getKey(), param.getValue()));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 模拟表单</span></span><br><span class="line">                <span class="type">UrlEncodedFormEntity</span> <span class="variable">entity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UrlEncodedFormEntity</span>(paramList);</span><br><span class="line">                httpPost.setEntity(entity);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            httpPost.setConfig(builderRequestConfig());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 执行http请求</span></span><br><span class="line">            response = httpClient.execute(httpPost);</span><br><span class="line"></span><br><span class="line">            resultString = EntityUtils.toString(response.getEntity(), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                response.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> resultString;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发送POST方式请求</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> url</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> paramMap</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">doPost4Json</span><span class="params">(String url, Map&lt;String, String&gt; paramMap)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 创建Httpclient对象</span></span><br><span class="line">        <span class="type">CloseableHttpClient</span> <span class="variable">httpClient</span> <span class="operator">=</span> HttpClients.createDefault();</span><br><span class="line">        <span class="type">CloseableHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">resultString</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 创建Http Post请求</span></span><br><span class="line">            <span class="type">HttpPost</span> <span class="variable">httpPost</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpPost</span>(url);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (paramMap != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="comment">//构造json格式数据</span></span><br><span class="line">                <span class="type">JSONObject</span> <span class="variable">jsonObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">                <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; param : paramMap.entrySet()) &#123;</span><br><span class="line">                    jsonObject.put(param.getKey(),param.getValue());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">StringEntity</span> <span class="variable">entity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringEntity</span>(jsonObject.toString(),<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">                <span class="comment">//设置请求编码</span></span><br><span class="line">                entity.setContentEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">                <span class="comment">//设置数据类型</span></span><br><span class="line">                entity.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">                httpPost.setEntity(entity);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            httpPost.setConfig(builderRequestConfig());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 执行http请求</span></span><br><span class="line">            response = httpClient.execute(httpPost);</span><br><span class="line"></span><br><span class="line">            resultString = EntityUtils.toString(response.getEntity(), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                response.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> resultString;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> RequestConfig <span class="title function_">builderRequestConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> RequestConfig.custom()</span><br><span class="line">                .setConnectTimeout(TIMEOUT_MSEC)</span><br><span class="line">                .setConnectionRequestTimeout(TIMEOUT_MSEC)</span><br><span class="line">                .setSocketTimeout(TIMEOUT_MSEC).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="微信小程序开发">微信小程序开发</h4>
<h5 id="介绍-3">介绍</h5>
<p>微信小程序，一种新的开放能力，可以在微信内被便捷地获取和传播，同时具有出色的使用体验。</p>
<p>官方介绍：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/cgi-bin/wx">公众号 (qq.com)</a></p>
<p>接入流程：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%85%A5%E6%B5%81%E7%A8%8B.png" class="">
<p>开放注册范围：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E6%94%BE%E6%B3%A8%E5%86%8C%E8%8C%83%E5%9B%B4.png" class="">
<p>不同的注册范围享有不同的权限，个人注册范围无法接入微信支付功能</p>
<h5 id="准备工作">准备工作</h5>
<p>开发微信小程序之前需要做如下准备工作：</p>
<ul>
<li>注册小程序</li>
<li>完善小程序信息</li>
<li>下载开发者工具</li>
</ul>
<h5 id="入门案例-2">入门案例</h5>
<p>步骤</p>
<ul>
<li>了解小程序目录结构</li>
<li>编写小程序代码</li>
<li>编译小程序</li>
</ul>
<h6 id="目录结构">目录结构</h6>
<p>小程序包含一个描述整体程序的 app 和多个描述各自页面的 page。</p>
<p>一个小程序的主体部分由三个文件组成，必须放在项目的根目录，如下：</p>
<table>
<thead>
<tr>
<th>文件</th>
<th>必需</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>app.js</td>
<td>是</td>
<td>小程序逻辑</td>
</tr>
<tr>
<td>app.json</td>
<td>是</td>
<td>小程序公共配置</td>
</tr>
<tr>
<td>app.wxss</td>
<td>否</td>
<td>小程序公共样式表</td>
</tr>
</tbody>
</table>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84.png" class="">
<p>一个小程序的页面由四个文件组成：</p>
<table>
<thead>
<tr>
<th>文件类型</th>
<th>必需</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>js</td>
<td>是</td>
<td>页面逻辑</td>
</tr>
<tr>
<td>wxml</td>
<td>是</td>
<td>页面结构</td>
</tr>
<tr>
<td>json</td>
<td>否</td>
<td>页面配置</td>
</tr>
<tr>
<td>wxss</td>
<td>否</td>
<td>页面样式表</td>
</tr>
</tbody>
</table>
<h6 id="导入小程序代码">导入小程序代码</h6>
<h4 id="微信登录-2">微信登录</h4>
<h5 id="微信登录流程">微信登录流程</h5>
<p>帮助文档：<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html">开放能力 / 用户信息 / 小程序登录 (qq.com)</a></p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E6%B5%81%E7%A8%8B%E5%9B%BE.jpg" class="">
<h5 id="需求分析与设计">需求分析与设计</h5>
<h5 id="代码开发-3">代码开发</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> UserLoginVO <span class="title function_">login</span><span class="params">(UserLoginDTO userLoginDTO)</span> &#123;</span><br><span class="line">    <span class="comment">// 通过前端code获得用户的openid（微信用户唯一标识）</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">openid</span> <span class="operator">=</span> getOpenid(userLoginDTO.getCode());</span><br><span class="line">    <span class="comment">// 验证openid是否为空，为空则传递参数code有误，登录失败</span></span><br><span class="line">    <span class="keyword">if</span> (openid == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">LoginFailedException</span>(MessageConstant.LOGIN_FAILED);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 获取数据库中的该user信息</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.getByOpenId(openid);</span><br><span class="line">    <span class="comment">// 如果user为空，则该用户为新用户，为其注册</span></span><br><span class="line">    <span class="keyword">if</span> (user == <span class="literal">null</span>) &#123;</span><br><span class="line">        user = User.builder().openid(openid).createTime(LocalDateTime.now()).build();</span><br><span class="line">        save(user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 生成jwt令牌</span></span><br><span class="line">    Map&lt;String, Object&gt; claims = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    claims.put(JwtClaimsConstant.USER_ID, user.getId());</span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> JwtUtil.createJWT(jwtProperties.getUserSecretKey(), jwtProperties.getUserTtl(), claims);</span><br><span class="line">    <span class="comment">// 返回UserLoginVO对象</span></span><br><span class="line">    <span class="keyword">return</span> UserLoginVO.builder().id(user.getId()).openid(user.getOpenid()).token(token).build();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String <span class="title function_">getOpenid</span><span class="params">(String code)</span> &#123;</span><br><span class="line">    <span class="comment">// 通过前端code获得用户的openid（微信用户唯一标识）</span></span><br><span class="line">    HashMap&lt;String, String&gt; params = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    params.put(<span class="string">&quot;appid&quot;</span>, weChatProperties.getAppid());</span><br><span class="line">    params.put(<span class="string">&quot;secret&quot;</span>, weChatProperties.getSecret());</span><br><span class="line">    params.put(<span class="string">&quot;js_code&quot;</span>, code);</span><br><span class="line">    params.put(<span class="string">&quot;grant_type&quot;</span>, <span class="string">&quot;authorization_code&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">response</span> <span class="operator">=</span> HttpClientUtil.doGet(LOGIN_URL, params);</span><br><span class="line"></span><br><span class="line">    <span class="type">JSONObject</span> <span class="variable">jsonObject</span> <span class="operator">=</span> JSON.parseObject(response);</span><br><span class="line">    <span class="keyword">return</span> jsonObject.getString(<span class="string">&quot;openid&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="功能测试-3">功能测试</h5>
<h4 id="导入商品浏览功能模块">导入商品浏览功能模块</h4>
<h5 id="需求分析与设计-2">需求分析与设计</h5>
<h6 id="接口设计">接口设计</h6>
<ul>
<li>查询分类</li>
<li>根据分类 id 查询菜品（关联口味数据）</li>
<li>根据分类 id 查询套餐</li>
<li>根据套餐 id 查询包含的菜品</li>
</ul>
<h5 id="代码开发-4">代码开发</h5>
<h5 id="功能测试-4">功能测试</h5>
<h3 id="缓存商品">缓存商品</h3>
<h4 id="缓存菜品">缓存菜品</h4>
<h5 id="问题说明">问题说明</h5>
<p>用户端小程序展示的菜品数据都是通过查询数据库来获得，如果短时间内有大量查询请求，则数据库访问压力过大，会造成查询响应慢，用户体验差。</p>
<h5 id="实现思路">实现思路</h5>
<p>通过 Redis 来缓存菜品数据，减少数据库查询操作（内存访问速度比磁盘 IO 访问速度快得多）</p>
<p>查询思路：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E6%9F%A5%E8%AF%A2%E6%80%9D%E8%B7%AF.png" class="">
<p>缓存逻辑分析：</p>
<ul>
<li>每个分类下的菜品缓存一份数据，即一个分类对应一个 key-value 键值对</li>
<li>数据库中菜品数据有变更时要清理缓存数据</li>
</ul>
<h5 id="代码开发-5">代码开发</h5>
<h6 id="查询时添加缓存">查询时添加缓存</h6>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;根据分类id查询菜品&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;List&lt;DishVO&gt;&gt; <span class="title function_">list</span><span class="params">(Long categoryId)</span> &#123;</span><br><span class="line">    <span class="comment">// 构造key</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;dish_&quot;</span> + categoryId;</span><br><span class="line">    <span class="comment">// 查询redis中是否存在缓存数据</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">list</span> <span class="operator">=</span> (String) redisTemplate.opsForValue().get(key);</span><br><span class="line">    List&lt;DishVO&gt; data = JSON.parseArray(list, DishVO.class);</span><br><span class="line">    <span class="comment">// 存在缓存数据，直接返回给前端</span></span><br><span class="line">    <span class="keyword">if</span> (data != <span class="literal">null</span> &amp;&amp; !data.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">return</span> Result.success(data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 不存在缓存数据，则查询数据库，并添加到redis中</span></span><br><span class="line">    <span class="comment">// 查询</span></span><br><span class="line">    <span class="type">Dish</span> <span class="variable">dish</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dish</span>();</span><br><span class="line">    dish.setCategoryId(categoryId);</span><br><span class="line">    dish.setStatus(StatusConstant.ENABLE);<span class="comment">//查询起售中的菜品</span></span><br><span class="line"></span><br><span class="line">    data = dishService.listWithFlavor(dish);</span><br><span class="line">    <span class="comment">// 添加</span></span><br><span class="line">    redisTemplate.opsForValue().set(key, JSON.toJSONString(data));</span><br><span class="line">    <span class="comment">// 返回</span></span><br><span class="line">    <span class="keyword">return</span> Result.success(data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="修改时清理缓存">修改时清理缓存</h6>
<p>修改管理端接口 DishController 的相关方法，加入清理缓存逻辑，需要改造的方法：</p>
<ul>
<li>新增菜品</li>
<li>修改菜品</li>
<li>删除菜品</li>
<li>起售、停售菜品</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 清理redis缓存方法</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">cleanUpCache</span><span class="params">(String pattern)</span> &#123;</span><br><span class="line">    <span class="type">Set</span> <span class="variable">keys</span> <span class="operator">=</span> redisTemplate.keys(pattern);</span><br><span class="line">    redisTemplate.delete(keys);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="功能测试-5">功能测试</h5>
<h4 id="缓存套餐">缓存套餐</h4>
<h5 id="SpringCache">SpringCache</h5>
<h6 id="介绍-4">介绍</h6>
<p>SpringCache 是一个框架，实现了基于==注解==的缓存功能，只需要简单地加一个注解，就能实现缓存功能</p>
<p>SpringCache 提供了一层抽象，底层可以切换不同的缓存实现，例如：</p>
<ul>
<li>EHCache</li>
<li>Caffeine</li>
<li>Redis</li>
</ul>
<p>Maven 坐标</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-cache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>该框架会根据 maven 项目中导入的数据库来选择缓存实现，即如果项目中导入了 redis 的 Java 客户端，就无需其他配置，该框架会自动选择 redis 作为底层缓存实现。</p>
<h6 id="常用注解-2">常用注解</h6>
<table>
<thead>
<tr>
<th>注解</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>@EnableCaching</code></td>
<td>开启缓存注解功能，通常加在启动类上</td>
</tr>
<tr>
<td><code>@Cacheable</code></td>
<td>在方法执行前先查询缓存中是否有数据，如果有数据，则直接返回缓存数据；如果没有缓存数据，调用方法并将方法返回值放到缓存中</td>
</tr>
<tr>
<td><code>CachePut</code></td>
<td>将方法的返回值放到缓存中</td>
</tr>
<tr>
<td><code>CacheEvict</code></td>
<td>将一条或多条数据从缓存中删除</td>
</tr>
</tbody>
</table>
<h6 id="入门案例-3">入门案例</h6>
<p>案例一</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E6%A1%88%E4%BE%8B%E4%B8%80.png" class="">
<ul>
<li>使用 spring 的 el 表达式来动态地生成插入 redis 的 key 的名称</li>
<li>使用 <code>@CachePut</code> 注解来将方法的返回值保存到 redis 中</li>
<li>执行顺序：先执行方法，方法执行完之后再执行注解操作缓存</li>
</ul>
<p>案例二</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E6%A1%88%E4%BE%8B%E4%BA%8C.png" class="">
<ul>
<li><code>@Cacheable</code> 注解的属性同上</li>
<li>使用该注解来完成在方法执行前先查询缓存中是否有数据，如果有数据，则直接返回缓存数据；如果没有缓存数据，调用方法并将方法返回值放到缓存中</li>
<li>该注解中 el 表达式不能用 result 关键字</li>
</ul>
<p>案例三</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E6%A1%88%E4%BE%8B%E4%B8%89.png" class="">
<ul>
<li><code>@CacheEvict</code> 注解的属性也同上</li>
<li>执行顺序：先执行方法，方法执行完之后再执行注解</li>
<li>删除单条缓存数据</li>
</ul>
<p>案例四</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E6%A1%88%E4%BE%8B%E5%9B%9B.png" class="">
<ul>
<li>删除全部缓存数据</li>
<li>不使用 key 属性来指定单个 key，使用 <code>allEntries = true</code> 来指定全部前缀为 userCache 的 key</li>
</ul>
<h5 id="实现思路-2">实现思路</h5>
<p>具体的实现思路如下：</p>
<ul>
<li>导入 SpringCache 和 Redis 的相关 maven 坐标</li>
<li>在启动类上加入 <code>@EnableCaching</code> 注解</li>
<li>在用户端接口 SetmealController 的 list 方法上加入 <code>@Cacheable</code> 注解</li>
<li>在管理端 SetmealController 的 sava、delete、update、startOrStop 等方法上加入 <code>@CacheEvict</code> 注解</li>
</ul>
<h5 id="代码开发-6">代码开发</h5>
<h5 id="功能测试-6">功能测试</h5>
<h3 id="购物车">购物车</h3>
<h4 id="添加到购物车">添加到购物车</h4>
<h5 id="需求分析和设计-2">需求分析和设计</h5>
<p>接口设计：</p>
<ul>
<li>请求方式：POST</li>
<li>请求路径：/user/shoppingCart/add</li>
<li>请求参数：套餐 id、菜品 id、口味</li>
<li>返回结果：code、data、msg</li>
</ul>
<h5 id="代码开发-7">代码开发</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addToCart</span><span class="params">(ShoppingCartDTO shoppingCartDTO)</span> &#123;</span><br><span class="line">    <span class="comment">// 判断当前加入购物车的商品是否已存在，已存在的话更新商品的数量+1</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">id</span> <span class="operator">=</span> BaseContext.getCurrentId();</span><br><span class="line">    <span class="type">Long</span> <span class="variable">setmealId</span> <span class="operator">=</span> shoppingCartDTO.getSetmealId();</span><br><span class="line">    <span class="type">Long</span> <span class="variable">dishId</span> <span class="operator">=</span> shoppingCartDTO.getDishId();</span><br><span class="line">    <span class="type">String</span> <span class="variable">dishFlavor</span> <span class="operator">=</span> shoppingCartDTO.getDishFlavor();</span><br><span class="line">    LambdaQueryWrapper&lt;ShoppingCart&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;ShoppingCart&gt;()</span><br><span class="line">        .eq(id != <span class="literal">null</span>, ShoppingCart::getUserId, id)</span><br><span class="line">        .eq(setmealId != <span class="literal">null</span>, ShoppingCart::getSetmealId, setmealId)</span><br><span class="line">        .eq(dishId != <span class="literal">null</span>, ShoppingCart::getDishId, dishId)</span><br><span class="line">        .eq(dishFlavor != <span class="literal">null</span>, ShoppingCart::getDishFlavor, dishFlavor);</span><br><span class="line">    List&lt;ShoppingCart&gt; list = list(wrapper);</span><br><span class="line">    <span class="keyword">if</span> (list != <span class="literal">null</span> &amp;&amp; !list.isEmpty()) &#123;</span><br><span class="line">        LambdaUpdateWrapper&lt;ShoppingCart&gt; updateWrapper = <span class="keyword">new</span> <span class="title class_">LambdaUpdateWrapper</span>&lt;ShoppingCart&gt;()</span><br><span class="line">            .eq(ShoppingCart::getId, list.get(<span class="number">0</span>).getId())</span><br><span class="line">            .set(ShoppingCart::getNumber, list.get(<span class="number">0</span>).getNumber() + <span class="number">1</span>);</span><br><span class="line">        update(updateWrapper);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果当前商品不存在，则插入到购物车表中，默认数量为1</span></span><br><span class="line">    <span class="type">ShoppingCart</span> <span class="variable">shoppingCart</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ShoppingCart</span>();</span><br><span class="line">    <span class="keyword">if</span> (setmealId != <span class="literal">null</span> &amp;&amp; dishId == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">Setmeal</span> <span class="variable">setmeal</span> <span class="operator">=</span> setMealService.getById(setmealId);</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> setmeal.getName();</span><br><span class="line">        <span class="type">String</span> <span class="variable">image</span> <span class="operator">=</span> setmeal.getImage();</span><br><span class="line">        <span class="type">BigDecimal</span> <span class="variable">price</span> <span class="operator">=</span> setmeal.getPrice();</span><br><span class="line">        shoppingCart = ShoppingCart.builder().userId(id).name(name).setmealId(setmealId)</span><br><span class="line">            .number(<span class="number">1</span>).amount(price).image(image).createTime(LocalDateTime.now()).build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (setmealId == <span class="literal">null</span> &amp;&amp; dishId != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">Dish</span> <span class="variable">dish</span> <span class="operator">=</span> dishService.getById(dishId);</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> dish.getName();</span><br><span class="line">        <span class="type">String</span> <span class="variable">image</span> <span class="operator">=</span> dish.getImage();</span><br><span class="line">        <span class="type">BigDecimal</span> <span class="variable">price</span> <span class="operator">=</span> dish.getPrice();</span><br><span class="line">        shoppingCart = ShoppingCart.builder().userId(id).name(name).dishId(dishId)</span><br><span class="line">            .number(<span class="number">1</span>).amount(price).image(image).dishFlavor(dishFlavor).createTime(LocalDateTime.now()).build();</span><br><span class="line">    &#125;</span><br><span class="line">    save(shoppingCart);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="功能测试-7">功能测试</h5>
<h4 id="查看购物车">查看购物车</h4>
<h4 id="清空购物车">清空购物车</h4>
<h3 id="用户下单">用户下单</h3>
<h4 id="导入地址薄功能代码">导入地址薄功能代码</h4>
<h5 id="需求分析和设计-3">需求分析和设计</h5>
<p>业务功能</p>
<ul>
<li>查询地址列表</li>
<li>新增地址</li>
<li>修改地址</li>
<li>删除地址</li>
<li>设置默认地址</li>
<li>查询默认地址</li>
</ul>
<p>接口设计</p>
<ul>
<li>新增地址</li>
<li>查询当前登录用户的所有地址信息</li>
<li>查询默认地址</li>
<li>根据 id 修改地址</li>
<li>根据 id 删除地址</li>
<li>根据 id 查询地址</li>
<li>设置默认地址</li>
</ul>
<h5 id="导入代码">导入代码</h5>
<h5 id="功能测试-8">功能测试</h5>
<h4 id="用户下单-2">用户下单</h4>
<h5 id="需求分析与设计-3">需求分析与设计</h5>
<h6 id="用户下单业务说明：">用户下单业务说明：</h6>
<p>在电商系统中，用户是通过下单的方式通知商家，用户已经购买了商品，需要商家进行备货和发货</p>
<h6 id="用户下单后会产生订单相关数据，订单数据需要能够体现如下信息：">用户下单后会产生订单相关数据，订单数据需要能够体现如下信息：</h6>
<ul>
<li>买的哪些商品？每个商品的数量是多少（查询用户购物车获得）</li>
<li>订单总金额是多少？（程序计算得出）</li>
<li>收获地址是哪？（下单地址簿中查询）</li>
<li>哪个用户下的单？（下单地址簿中查询）</li>
<li>用户手机号是多少？（下单地址簿中查询）</li>
</ul>
<h6 id="用户点餐业务流程：">用户点餐业务流程：</h6>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E7%94%A8%E6%88%B7%E7%82%B9%E9%A4%90%E4%B8%9A%E5%8A%A1%E6%B5%81%E7%A8%8B.png" class="">
<h6 id="接口分析：">接口分析：</h6>
<p>请求方式：POST</p>
<p>请求路径：/user/order/submit</p>
<p>参数：</p>
<ul>
<li>地址薄 id</li>
<li>配送状态（立即送出、选择送出时间）</li>
<li>打包费</li>
<li>总金额</li>
<li>（配送费固定为6元，本项目中不考虑了）</li>
<li>备注</li>
<li>餐具数量</li>
</ul>
<p>返回数据：</p>
<ul>
<li>用户下单时间（用于前端倒计时）</li>
<li>订单总金额</li>
<li>订单号</li>
<li>订单 id（用于支付时确定订单）</li>
</ul>
<p>数据库设计：</p>
<ul>
<li>订单表（存储订单基本信息）
<ul>
<li>谁的订单？</li>
<li>送哪去？</li>
<li>打哪个电话联系？</li>
<li>多少钱？</li>
<li>什么时间下的单？</li>
<li>什么时间支付的？</li>
<li>订单的状态？</li>
<li>订单号是多少？</li>
</ul>
</li>
<li>订单明细表（存储订单菜品信息）
<ul>
<li>当前明细属于哪个订单？</li>
<li>具体点的是什么商品？</li>
<li>这个商品点了几份？</li>
</ul>
</li>
</ul>
<h5 id="代码开发-8">代码开发</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> OrderSubmitVO <span class="title function_">submit</span><span class="params">(OrdersSubmitDTO ordersSubmitDTO)</span> &#123;</span><br><span class="line">        <span class="comment">// 各种业务异常</span></span><br><span class="line">        <span class="comment">// 地址薄为空</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">addressBookId</span> <span class="operator">=</span> ordersSubmitDTO.getAddressBookId();</span><br><span class="line">        <span class="type">AddressBook</span> <span class="variable">address</span> <span class="operator">=</span> addressBookMapper.getById(addressBookId);</span><br><span class="line">        <span class="keyword">if</span> (address == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(MessageConstant.ADDRESS_BOOK_IS_NULL);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 购物车数据为空</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> BaseContext.getCurrentId();</span><br><span class="line">        LambdaQueryWrapper&lt;ShoppingCart&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;ShoppingCart&gt;()</span><br><span class="line">                .eq(userId != <span class="literal">null</span>, ShoppingCart::getUserId, userId);</span><br><span class="line">        List&lt;ShoppingCart&gt; shoppingCarts = shoppingCartService.list(wrapper);</span><br><span class="line">        <span class="keyword">if</span> (shoppingCarts == <span class="literal">null</span> || shoppingCarts.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(MessageConstant.SHOPPING_CART_IS_NULL);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 向订单表插入一条数据</span></span><br><span class="line">        <span class="type">Orders</span> <span class="variable">orders</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Orders</span>();</span><br><span class="line">        BeanUtils.copyProperties(ordersSubmitDTO, orders);</span><br><span class="line">        orders.setNumber(String.valueOf(System.currentTimeMillis()));</span><br><span class="line">        orders.setStatus(Orders.PENDING_PAYMENT);</span><br><span class="line">        orders.setUserId(userId);</span><br><span class="line">        orders.setOrderTime(LocalDateTime.now());</span><br><span class="line">        orders.setPayStatus(Orders.UN_PAID);</span><br><span class="line">        orders.setUserName(userService.getById(userId).getName());</span><br><span class="line">        orders.setPhone(address.getPhone());</span><br><span class="line">        orders.setAddress(address.getDetail());</span><br><span class="line">        orders.setConsignee(address.getConsignee());</span><br><span class="line"></span><br><span class="line">        save(orders);</span><br><span class="line">        <span class="comment">// 向订单明细表插入多条数据</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">ordersId</span> <span class="operator">=</span> orders.getId();</span><br><span class="line">        ArrayList&lt;OrderDetail&gt; orderDetails = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (ShoppingCart shoppingCart : shoppingCarts) &#123;</span><br><span class="line">            <span class="type">OrderDetail</span> <span class="variable">orderDetail</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderDetail</span>();</span><br><span class="line">            BeanUtils.copyProperties(shoppingCart, orderDetail);</span><br><span class="line">            orderDetail.setOrderId(ordersId);</span><br><span class="line">            orderDetails.add(orderDetail);</span><br><span class="line">        &#125;</span><br><span class="line">        orderDetailService.saveBatch(orderDetails);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 清空购物车</span></span><br><span class="line">        shoppingCartService.remove(wrapper);</span><br><span class="line">        <span class="comment">// 封装返回结果</span></span><br><span class="line">        <span class="keyword">return</span> OrderSubmitVO.builder().id(ordersId).orderAmount(ordersSubmitDTO</span><br><span class="line">                .getAmount()).orderNumber(orders.getNumber()).orderTime(orders.getOrderTime()).build();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h5 id="功能测试-9">功能测试</h5>
<h3 id="订单支付和管理">订单支付和管理</h3>
<h4 id="微信支付介绍">微信支付介绍</h4>
<h5 id="微信支付产品：">微信支付产品：</h5>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E4%BA%A7%E5%93%81.png" class="">
<p>参考文档：<a target="_blank" rel="noopener" href="https://pay.weixin.qq.com/static/product/product_index.shtml">https://pay.weixin.qq.com/static/product/product_index.shtml</a></p>
<h5 id="小程序微信支付接入流程：">小程序微信支付接入流程：</h5>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E6%8E%A5%E5%85%A5%E6%B5%81%E7%A8%8B.png" class="">
<h5 id="微信小程序支付时序图：">微信小程序支付时序图：</h5>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%94%AF%E4%BB%98%E6%97%B6%E5%BA%8F%E5%9B%BE.png" class="">
<h5 id="请求下单接口：">请求下单接口：</h5>
<ul>
<li>url：<a target="_blank" rel="noopener" href="https://api.mch.weixin.qq.com/v3/pay/transactions/jsapi">https://api.mch.weixin.qq.com/v3/pay/transactions/jsapi</a></li>
<li>请求方式：POST</li>
<li>提交参数：<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E6%8E%A5%E5%8F%A3%E6%8F%90%E4%BA%A4%E5%8F%82%E6%95%B0.png" class="">
<ul>
<li>mchid：商户号</li>
<li>out_trade_no：订单号（自己定义的）</li>
<li>appid：小程序的 appid</li>
<li>description：描述</li>
<li>notify_url：回调地址，即调用成功后商户接收返回响应数据的地址</li>
<li>amount
<ul>
<li>total：总金额</li>
<li>currency：货币</li>
</ul>
</li>
<li>payer
<ul>
<li>openid：支付者的 openid</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="关键阶段：">关键阶段：</h5>
<ul>
<li>商户系统调用下单接口</li>
<li>小程序调用 <code>wx.requestPayment</code> 方法完成支付</li>
<li>商户系统获取到支付结果，更新订单状态</li>
</ul>
<h5 id="JSAPI-下单详细说明">JSAPI 下单详细说明</h5>
<p>接口文档：<a target="_blank" rel="noopener" href="https://pay.weixin.qq.com/docs/merchant/apis/jsapi-payment/direct-jsons/jsapi-prepay.html">JSAPI下单 - JSAPI支付 | 微信支付商户文档中心 (qq.com)</a></p>
<p>请求参数：详见接口文档</p>
<p>请求示例：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">curl -X POST \</span><br><span class="line">  https<span class="punctuation">:</span><span class="comment">//api.mch.weixin.qq.com/v3/pay/transactions/jsapi \</span></span><br><span class="line">  -H <span class="string">&quot;Authorization: WECHATPAY2-SHA256-RSA2048 mchid=\&quot;1900000001\&quot;,...&quot;</span> \</span><br><span class="line">  -H <span class="string">&quot;Accept: application/json&quot;</span> \</span><br><span class="line">  -H <span class="string">&quot;Content-Type: application/json&quot;</span> \</span><br><span class="line">  -d &#x27;<span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;appid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;wxd678efh567hg6787&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;mchid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1230000109&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Image形象店-深圳腾大-QQ公仔&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;out_trade_no&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1217752501201407033233368018&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;time_expire&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;2018-06-08T10:34:56+08:00&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;attach&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;自定义数据说明&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;notify_url&quot;</span> <span class="punctuation">:</span> <span class="string">&quot; https://www.weixin.qq.com/wxpay/pay.php&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;goods_tag&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;WXG&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;support_fapiao&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;amount&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;total&quot;</span> <span class="punctuation">:</span> <span class="number">100</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;currency&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;CNY&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;payer&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;openid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;oUpF8uMuAJO_M2pxb1Q9zNjWeS6o\t&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;detail&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;cost_price&quot;</span> <span class="punctuation">:</span> <span class="number">608800</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;invoice_id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;微信123&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;goods_detail&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;merchant_goods_id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1246464644&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;wechatpay_goods_id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1001&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;goods_name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;iPhoneX 256G&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;quantity&quot;</span> <span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;unit_price&quot;</span> <span class="punctuation">:</span> <span class="number">528800</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;scene_info&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;payer_client_ip&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;14.23.150.211&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;device_id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;013467007045764&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;store_info&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;0001&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;腾讯大厦分店&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;area_code&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;440305&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;address&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;广东省深圳市南山区科技中一道10000号&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;settle_info&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;profit_sharing&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span>&#x27;</span><br></pre></td></tr></table></figure>
<p>响应参数：</p>
<ul>
<li>
<p>200  OK</p>
</li>
<li>
<p><strong>prepay_id</strong> 必填 string(64)</p>
<blockquote>
<p><strong>【预支付交易会话标识】</strong> 预支付交易会话标识。用于后续接口调用中使用，该值有效期为2小时</p>
</blockquote>
</li>
</ul>
<p>响应示例：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;prepay_id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;wx201410272009395522657a690389285100&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<h5 id="微信小程序调起支付">微信小程序调起支付</h5>
<p>通过JSAPI下单接口获取到发起支付的必要参数prepay_id，然后使用微信支付提供的小程序方法调起小程序支付。</p>
<p>接口名称：wx.requestPayment</p>
<p>请求参数：</p>
<ul>
<li>
<p>**timeStamp **必填 string(32)</p>
<blockquote>
<p>时间戳，标准北京时间，时区为东八区，自1970年1月1日 0点0分0秒以来的秒数。注<br>
意：部分系统取到的值为毫秒级，需要转换成秒(10位数字)。</p>
</blockquote>
</li>
<li>
<p><strong>nonceStr</strong> 必填 string(32)</p>
<blockquote>
<p>随机字符串，不长于32位。</p>
</blockquote>
</li>
<li>
<p>**package **必填 string(128)</p>
<blockquote>
<p>小程序下单接口返回的<code>prepay_id</code>参数值，提交格式如：<code>prepay_id=***</code></p>
</blockquote>
</li>
<li>
<p>**signType **必填 string(32)</p>
<blockquote>
<p>签名类型，默认为RSA，仅支持RSA。</p>
</blockquote>
</li>
<li>
<p>**paySign **必填 string(512)</p>
<blockquote>
<p>签名，使用字段<code>appid</code>、<code>timeStamp</code>、<code>nonceStr</code>、<code>package</code>计算得出的签名值<br>
签名所使用的<code>appid</code>，为【小程序下单】时传入的<code>appid</code>，微信支付会校验下单与调<br>
起支付所使用的<code>appid</code>的一致性。</p>
</blockquote>
</li>
</ul>
<p>请求示例：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">wx.requestPayment</span><br><span class="line">(</span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;timeStamp&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1414561699&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;nonceStr&quot;</span><span class="punctuation">:</span> <span class="string">&quot;5K8264ILTKCH16CQ2502SI8ZNMTM67VS&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;package&quot;</span><span class="punctuation">:</span> <span class="string">&quot;prepay_id=wx201410272009395522657a690389285100&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RSA&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paySign&quot;</span><span class="punctuation">:</span> <span class="string">&quot;oR9d8PuhnIc+YZ8cBHFCwfgpaK9gd7vaRvkYD7rthRAZ\/X+QBhcCYL21N7cHCTUxbQ+EAt6Uy+lwSN22f5YZvI45MLko8Pfso0jm46v5hqcVwrk6uddkGuT+Cdvu4WBqDzaDjnNa5UK3GfE1Wfl2gHxIIY5lLdUgWFts17D4WuolLLkiFZV+JSHMvH7eaLdT9N5GBovBwu5yYKUR7skR8Fu+LozcSqQixnlEZUfyE55feLOQTUYzLmR9pNtPbPsu6WVhbNHMS3Ss2+AehHvz+n64GDmXxbX++IOBvm2olHu3PsOUGRwhudhVf7UcGcunXt8cqNjKNqZLhLw4jq\/xDg==&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;success&quot;</span><span class="punctuation">:</span>function(res)<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;fail&quot;</span><span class="punctuation">:</span>function(res)<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;complete&quot;</span><span class="punctuation">:</span>function(res)<span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>回调结果：</p>
<table>
<thead>
<tr>
<th style="text-align:left">回调类型</th>
<th style="text-align:left">errMsg</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">success</td>
<td style="text-align:left">requestPayment:ok</td>
<td style="text-align:left">调用支付成功</td>
</tr>
<tr>
<td style="text-align:left">fail</td>
<td style="text-align:left">requestPayment:fail cancel</td>
<td style="text-align:left">用户取消支付</td>
</tr>
<tr>
<td style="text-align:left">fail</td>
<td style="text-align:left">requestPayment:fail (detail message)</td>
<td style="text-align:left">调用支付失败，其中 <code>detail message</code> 为后台返回的详细失败原因</td>
</tr>
</tbody>
</table>
<h4 id="微信支付准备工作">微信支付准备工作</h4>
<h6 id="调用过程如何保证数据安全？">调用过程如何保证数据安全？</h6>
<p>获取微信支付平台证书、商户私钥文件：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/image-20240320202602246.png" class="">
<h6 id="微信后台如何调用到商户系统？">微信后台如何调用到商户系统？</h6>
<p>获取临时域名：支付成功后微信服务通过该域名回调我们的程序</p>
<p>使用 cpolar 进行内网穿透获得临时公网 ip</p>
<h4 id="代码导入">代码导入</h4>
<h4 id="功能测试-10">功能测试</h4>
<h3 id="历史订单">历史订单</h3>
<h3 id="订单状态定时处理">订单状态定时处理</h3>
<p>待实现功能：</p>
<ul>
<li>支付超时订单自动取消</li>
<li>派送过久订单自动完成</li>
<li>来单提醒</li>
<li>催单提醒</li>
</ul>
<h4 id="Spring-Task">Spring Task</h4>
<h5 id="介绍-5">介绍</h5>
<p>Spring Task 是 Spring 框架提供的任务调度工具，可以按照约定的时间<strong>自动执行</strong>某个代码逻辑</p>
<p>应用场景：</p>
<ul>
<li>信用卡每月还款提醒</li>
<li>银行贷款每月还款提醒</li>
<li>火车票售票系统处理未支付订单</li>
<li>入职纪念日为用户发送通知</li>
<li>只要是需要定时处理的场景都可以使用</li>
</ul>
<h5 id="cron-表达式">cron 表达式</h5>
<p>cron 表达式其实就是一个字符串，通过 cron 表达式可以<strong>定义任务触发的时间</strong></p>
<p>构成规则：分为 6 或 7 个域，由空格分隔开，每个域代表一个含义</p>
<p>每个域的含义分别为：秒、分、时、日、月、周、年（可选）</p>
<p>例如：2022 年 10 月 12 日上午 9 点整对应的表达式为：“0 0 9 12 10 ? 2022”</p>
<p>日和周往往只能定义一个：因为日和星期几不一定能对应</p>
<p>cron 表达式在线生成器：<a target="_blank" rel="noopener" href="https://cron.ciding.cc/">Cron - 在线Cron表达式生成器 (ciding.cc)</a></p>
<h5 id="入门案例-4">入门案例</h5>
<p>使用步骤：</p>
<ol>
<li>导入 maven 坐标 spring-context（已被包含在 <code>org.springframework.boot:spring-boot-starter</code> 中）</li>
<li>启动类添加注解 <code>@EnableScheduling</code> 开启任务调度</li>
<li>自定义定时任务类</li>
</ol>
<h4 id="订单状态定时处理-2">订单状态定时处理</h4>
<h5 id="需求分析-2">需求分析</h5>
<p>用户下单后可能存在的情况</p>
<ul>
<li>下单后未支付，订单一直处于 “待支付” 状态</li>
<li>用户收货后管理端未点击完成按钮，订单一直处于 “派送中” 状态</li>
</ul>
<p>解决办法为：</p>
<ul>
<li>通过定时任务每分钟检查一次是否存在支付超时的订单（下单后超过 15 分钟仍未支付则判定为支付超时订单），如果存在则修改订单状态为 “已取消”</li>
<li>通过定时任务每天凌晨 1 点检查一次是否存在 “派送中” 的订单，如果存在则修改订单状态为 “已完成”</li>
</ul>
<h5 id="代码开发-9">代码开发</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理超时订单</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// 每分钟触发一次</span></span><br><span class="line"><span class="meta">@Scheduled(cron = &quot;0 0/1 * * * ?&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleTimeoutOrder</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 拿到全部超时未付款的订单的id</span></span><br><span class="line">    LambdaQueryWrapper&lt;Orders&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;Orders&gt;()</span><br><span class="line">        <span class="comment">// 超时的订单</span></span><br><span class="line">        .le(Orders::getOrderTime, LocalDateTime.now().minusMinutes(<span class="number">15</span>))</span><br><span class="line">        <span class="comment">// 未付款的订单</span></span><br><span class="line">        .eq(Orders::getStatus, Orders.PENDING_PAYMENT);</span><br><span class="line">    List&lt;Long&gt; ids = orderService.list(wrapper).stream().map(Orders::getId).collect(Collectors.toList());</span><br><span class="line">    <span class="comment">// 更新这些订单的状态为已取消</span></span><br><span class="line">    orderService.cancelTimeoutOrder(ids);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理派送中订单</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// 每天凌晨一点触发一次</span></span><br><span class="line"><span class="meta">@Scheduled(cron = &quot;0 0 1 * * ?&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleDeliveryInProgressOrder</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 拿到全部处于派送中状态的订单的id</span></span><br><span class="line">    LambdaQueryWrapper&lt;Orders&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;Orders&gt;()</span><br><span class="line">        <span class="comment">// 派送中的订单</span></span><br><span class="line">        .eq(Orders::getStatus, Orders.DELIVERY_IN_PROGRESS)</span><br><span class="line">        <span class="comment">// 前一天的订单</span></span><br><span class="line">        .ge(Orders::getOrderTime, LocalDateTime.now().minusDays(<span class="number">1</span>));</span><br><span class="line">    List&lt;Long&gt; ids = orderService.list(wrapper).stream().map(Orders::getId).collect(Collectors.toList());</span><br><span class="line">    <span class="comment">// 更新这些订单的状态为已完成</span></span><br><span class="line">    orderService.completeDeliveryInProgressOrder(ids);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="功能测试-11">功能测试</h5>
<h3 id="来单提醒和客户催单">来单提醒和客户催单</h3>
<h4 id="WebSocket">WebSocket</h4>
<h5 id="介绍-6">介绍</h5>
<p>WebSocket 是基于 TCP 的一种新的<strong>网络协议</strong>。它实现了浏览器与服务器全双工通信——浏览器和服务器只需要完成一次握手，两者之间就可以创建<strong>持久性</strong>的连接，并进行<strong>双向</strong>数据传输。</p>
<p>WebSocket 协议和 HTTP 协议的异同点：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/WebSocket%E5%92%8CHttp.png" class="">
<p>应用场景：</p>
<ul>
<li>视频弹幕</li>
<li>网页聊天</li>
<li>体育实况更新</li>
<li>股票基金报价实时更新</li>
</ul>
<h5 id="入门案例-5">入门案例</h5>
<p>实现步骤：</p>
<ul>
<li>直接使用 websocket.html 页面作为 WebSocket 客户端</li>
<li>导入 WebSocket 的 maven 坐标</li>
<li>导入 WebSocket 服务端组件 webSocketServer，用于和客户端通信</li>
<li>导入配置类 WebSocketConfiguration，注册 WebSocket 的服务端组件</li>
<li>导入定时任务类 WebSocketTask，定时向客户端推送数据</li>
</ul>
<h4 id="来单提醒">来单提醒</h4>
<h5 id="需求分析与设计-4">需求分析与设计</h5>
<p>用户下单并且支付成功后，需要第一时间通知外卖商家。通知的形式有如下两种：</p>
<ul>
<li>语音播报</li>
<li>弹出提示框</li>
</ul>
<p>设计：</p>
<ul>
<li>通过 WebSocket 实现管理端页面和服务端保持长连接</li>
<li>当客户支付后，调用 WebSocket 的相关 API 实现服务端向管理端页面推送消息</li>
<li>管理端浏览器解析服务端推送的消息，判断是来单提醒还是客户催单，进行响应的消息提示和语音播报</li>
<li>约定服务端发送给管理端浏览器的数据格式为 JSON，字段包括：type, orderId, content
<ul>
<li>type 为消息类型，1 为来单提醒，2 为客户催单</li>
<li>orderId 为订单 Id</li>
<li>content 为消息内容</li>
</ul>
</li>
</ul>
<h5 id="代码开发-10">代码开发</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 来单提醒</span></span><br><span class="line">HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">map.put(<span class="string">&quot;type&quot;</span>, <span class="number">1</span>);</span><br><span class="line">map.put(<span class="string">&quot;orderId&quot;</span>, ordersDB.getId());</span><br><span class="line">map.put(<span class="string">&quot;content&quot;</span>, <span class="string">&quot;订单号：&quot;</span> + outTradeNo);</span><br><span class="line"><span class="type">String</span> <span class="variable">jsonString</span> <span class="operator">=</span> JSON.toJSONString(map);</span><br><span class="line">webSocketServer.sendToAllClient(jsonString);</span><br></pre></td></tr></table></figure>
<h5 id="功能测试-12">功能测试</h5>
<h4 id="客户催单">客户催单</h4>
<h5 id="需求分析与设计-5">需求分析与设计</h5>
<p>用户在小程序点击催单按钮后，需要第一时间通知外卖商家。通知的形式有如下两种：</p>
<ul>
<li>语音播报</li>
<li>弹出提示框</li>
</ul>
<p>设计：</p>
<ul>
<li>通过 WebSocket 实现管理端页面和服务端保持长连接</li>
<li>当客户点击催单按钮后，调用 WebSocket 的相关 API 实现服务端向管理端页面推送消息</li>
<li>管理端浏览器解析服务端推送的消息，判断是来单提醒还是客户催单，进行响应的消息提示和语音播报</li>
<li>约定服务端发送给管理端浏览器的数据格式为 JSON，字段包括：type, orderId, content
<ul>
<li>type 为消息类型，1 为来单提醒，2 为客户催单</li>
<li>orderId 为订单 Id</li>
<li>content 为消息内容</li>
</ul>
</li>
</ul>
<h5 id="代码开发-11">代码开发</h5>
<p>设计催单接口</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%82%AC%E5%8D%95%E6%8E%A5%E5%8F%A3.png" class="">
<p>代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remindOrder</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="type">Orders</span> <span class="variable">orders</span> <span class="operator">=</span> getById(id);</span><br><span class="line">    <span class="keyword">if</span> (orders == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(MessageConstant.ORDER_NOT_FOUND);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;type&quot;</span>, <span class="number">2</span>);</span><br><span class="line">    map.put(<span class="string">&quot;orderId&quot;</span>, id);</span><br><span class="line">    map.put(<span class="string">&quot;content&quot;</span>, <span class="string">&quot;订单号：&quot;</span> + orders.getNumber());</span><br><span class="line">    <span class="type">String</span> <span class="variable">jsonString</span> <span class="operator">=</span> JSON.toJSONString(map);</span><br><span class="line"></span><br><span class="line">    webSocketServer.sendToAllClient(jsonString);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="功能测试-13">功能测试</h5>
<h2 id="统计报表模块">统计报表模块</h2>
<h3 id="图形报表设计">图形报表设计</h3>
<h4 id="Apache-EChatrs">Apache EChatrs</h4>
<h5 id="介绍-7">介绍</h5>
<p>Apache ECharts 是一款基于 JavaScrpit 的数据可视化图表库，提供直观、生动、可交互、可个性化定制的数据可视化图表</p>
<p>官网：<a target="_blank" rel="noopener" href="https://echarts.apache.org/zh/index.html">https://echarts.apache.org/zh/index.html</a></p>
<h5 id="入门案例-6">入门案例</h5>
<p>根据官方提供的快速入门案例：<a target="_blank" rel="noopener" href="https://echarts.apache.org/handbook/zh/get-started/">https://echarts.apache.org/handbook/zh/get-started/</a></p>
<p>总结：使用 ECharts，重点在于研究当前图表所需的数据格式。通常是需要后端提供符合格式要求的动态数据，然后响应给前端来展示图表。</p>
<h4 id="营业额统计">营业额统计</h4>
<h5 id="需求分析与设计-6">需求分析与设计</h5>
<p>需求分析：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E8%90%A5%E4%B8%9A%E9%A2%9D%E7%BB%9F%E8%AE%A1%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90.png" class="">
<p>接口设计：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E8%90%A5%E4%B8%9A%E9%A2%9D%E7%BB%9F%E8%AE%A1%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1.png" class="">
<h5 id="代码开发-12">代码开发</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> TurnoverReportVO <span class="title function_">turnoverReport</span><span class="params">(LocalDate begin, LocalDate end)</span> &#123;</span><br><span class="line">    <span class="comment">// 封装返回的list集合</span></span><br><span class="line">    ArrayList&lt;LocalDate&gt; times = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    times.add(begin);</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="type">LocalDate</span> <span class="variable">added</span> <span class="operator">=</span> begin.plusDays(count++);</span><br><span class="line">        <span class="keyword">if</span> (added.isAfter(end)) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        times.add(added);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 查询在begin和end之间每天的营业额</span></span><br><span class="line">    ArrayList&lt;Double&gt; turnovers = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (LocalDate time : times) &#123;</span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">beginTime</span> <span class="operator">=</span> LocalDateTime.of(time, LocalTime.MIN);</span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">endTime</span> <span class="operator">=</span> LocalDateTime.of(time, LocalTime.MAX);</span><br><span class="line">        <span class="type">Double</span> <span class="variable">turnover</span> <span class="operator">=</span> reportMapper.getTurnover(beginTime, endTime);</span><br><span class="line">        turnover = turnover == <span class="literal">null</span> ? <span class="number">0.0</span> : turnover;</span><br><span class="line">        turnovers.add(turnover);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 封装返回数据</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TurnoverReportVO</span>(StringUtils.join(times, <span class="string">&quot;,&quot;</span>), StringUtils.join(turnovers, <span class="string">&quot;,&quot;</span>));</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="功能测试-14">功能测试</h5>
<h4 id="用户统计">用户统计</h4>
<h5 id="需求分析与设计-7">需求分析与设计</h5>
<p>需求分析：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E7%94%A8%E6%88%B7%E7%BB%9F%E8%AE%A1%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90.png" class="">
<p>接口设计：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E7%94%A8%E6%88%B7%E7%BB%9F%E8%AE%A1%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1.png" class="">
<h5 id="代码开发-13">代码开发</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> UserReportVO <span class="title function_">userReport</span><span class="params">(LocalDate begin, LocalDate end)</span> &#123;</span><br><span class="line">    <span class="comment">// 封装返回的list集合</span></span><br><span class="line">    ArrayList&lt;LocalDate&gt; times = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    times.add(begin);</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="type">LocalDate</span> <span class="variable">added</span> <span class="operator">=</span> begin.plusDays(count++);</span><br><span class="line">        <span class="keyword">if</span> (added.isAfter(end)) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        times.add(added);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 拿到每日用户总量和新增用户数量</span></span><br><span class="line">    ArrayList&lt;Integer&gt; newUserNums = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    ArrayList&lt;Integer&gt; totalUserNums = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (LocalDate time : times) &#123;</span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">beginTime</span> <span class="operator">=</span> LocalDateTime.of(time, LocalTime.MIN);</span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">endTime</span> <span class="operator">=</span> LocalDateTime.of(time, LocalTime.MAX);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">newUserNum</span> <span class="operator">=</span> reportMapper.newUserNum(beginTime, endTime);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">totalUserNum</span> <span class="operator">=</span> reportMapper.totalUserNum(endTime);</span><br><span class="line">        <span class="comment">// count不会返回null，只会返回0，所以不需要三元运算符判断</span></span><br><span class="line">        newUserNums.add(newUserNum);</span><br><span class="line">        totalUserNums.add(totalUserNum);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> UserReportVO.builder()</span><br><span class="line">            .dateList(StringUtils.join(times, <span class="string">&quot;,&quot;</span>))</span><br><span class="line">            .newUserList(StringUtils.join(newUserNums, <span class="string">&quot;,&quot;</span>))</span><br><span class="line">            .totalUserList(StringUtils.join(totalUserNums, <span class="string">&quot;,&quot;</span>))</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="功能测试-15">功能测试</h5>
<h4 id="订单统计">订单统计</h4>
<h5 id="需求分析与设计-8">需求分析与设计</h5>
<p>需求分析：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E8%AE%A2%E5%8D%95%E7%BB%9F%E8%AE%A1%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90.png" class="">
<p>接口设计：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E8%AE%A2%E5%8D%95%E7%BB%9F%E8%AE%A1%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1.png" class="">
<h5 id="代码开发-14">代码开发</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> OrderReportVO <span class="title function_">orderReport</span><span class="params">(LocalDate begin, LocalDate end)</span> &#123;</span><br><span class="line">    <span class="comment">// 封装返回的list集合</span></span><br><span class="line">    ArrayList&lt;LocalDate&gt; times = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    times.add(begin);</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="type">LocalDate</span> <span class="variable">added</span> <span class="operator">=</span> begin.plusDays(count++);</span><br><span class="line">        <span class="keyword">if</span> (added.isAfter(end)) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        times.add(added);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 查询需要的订单数据</span></span><br><span class="line">    ArrayList&lt;Integer&gt; totalOrderNums = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    ArrayList&lt;Integer&gt; validOrderNums = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    Integer totalNums;</span><br><span class="line">    Integer validNums;</span><br><span class="line">    <span class="keyword">for</span> (LocalDate time : times) &#123;</span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">beginTime</span> <span class="operator">=</span> LocalDateTime.of(time, LocalTime.MIN);</span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">endTime</span> <span class="operator">=</span> LocalDateTime.of(time, LocalTime.MAX);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">totalOrderNum</span> <span class="operator">=</span> reportMapper.totalOrderNum(beginTime, endTime);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">validOrderNum</span> <span class="operator">=</span> reportMapper.validOrderNum(beginTime, endTime);</span><br><span class="line">        totalOrderNums.add(totalOrderNum);</span><br><span class="line">        validOrderNums.add(validOrderNum);</span><br><span class="line">    &#125;</span><br><span class="line">    totalNums = totalOrderNums.stream().mapToInt(Integer::intValue).sum();</span><br><span class="line">    validNums = validOrderNums.stream().mapToInt(Integer::intValue).sum();</span><br><span class="line">    <span class="type">Double</span> <span class="variable">completionRate</span> <span class="operator">=</span> totalNums == <span class="number">0</span> ? <span class="number">0.0</span> : <span class="number">1.0</span> * validNums / totalNums;</span><br><span class="line">    <span class="keyword">return</span> OrderReportVO.builder()</span><br><span class="line">            .dateList(StringUtils.join(times, <span class="string">&quot;,&quot;</span>))</span><br><span class="line">            .orderCountList(StringUtils.join(totalOrderNums, <span class="string">&quot;,&quot;</span>))</span><br><span class="line">            .validOrderCountList(StringUtils.join(validOrderNums, <span class="string">&quot;,&quot;</span>))</span><br><span class="line">            .totalOrderCount(totalNums)</span><br><span class="line">            .validOrderCount(validNums)</span><br><span class="line">            .orderCompletionRate(completionRate)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="功能测试-16">功能测试</h5>
<h4 id="销量排名-top10">销量排名 top10</h4>
<h5 id="需求分析与设计-9">需求分析与设计</h5>
<p>需求分析：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E9%94%80%E9%87%8F%E6%8E%92%E5%90%8D%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90.png" class="">
<p>接口设计：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E9%94%80%E9%87%8F%E6%8E%92%E5%90%8D%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1.png" class="">
<h5 id="代码开发-15">代码开发</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> SalesTop10ReportVO <span class="title function_">salesTop10</span><span class="params">(LocalDate begin, LocalDate end)</span> &#123;</span><br><span class="line">    <span class="comment">// 拿到该时间段内的销量前十的菜品</span></span><br><span class="line">    <span class="type">LocalDateTime</span> <span class="variable">beginTime</span> <span class="operator">=</span> LocalDateTime.of(begin, LocalTime.MIN);</span><br><span class="line">    <span class="type">LocalDateTime</span> <span class="variable">endTime</span> <span class="operator">=</span> LocalDateTime.of(end, LocalTime.MAX);</span><br><span class="line">    List&lt;GoodsSalesDTO&gt; data = reportMapper.salesTop10(beginTime, endTime);</span><br><span class="line">    List&lt;String&gt; names = data.stream().map(GoodsSalesDTO::getName).collect(Collectors.toList());</span><br><span class="line">    List&lt;Integer&gt; numbers = data.stream().map(GoodsSalesDTO::getNumber).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> SalesTop10ReportVO.builder()</span><br><span class="line">            .nameList(StringUtils.join(names, <span class="string">&quot;,&quot;</span>))</span><br><span class="line">            .numberList(StringUtils.join(numbers, <span class="string">&quot;,&quot;</span>))</span><br><span class="line">            .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="功能测试-17">功能测试</h5>
<h4 id="工作台设计与实现">工作台设计与实现</h4>
<h5 id="需求分析与设计-10">需求分析与设计</h5>
<p>工作台是系统运营的数据看板，并提供快捷的操作入口，可以有效提高商家的效率</p>
<p>工作台展示的数据：</p>
<ul>
<li>今日数据</li>
<li>订单总览</li>
<li>菜品总览</li>
<li>套餐总览</li>
<li>订单信息</li>
</ul>
<p>接口设计：</p>
<ul>
<li>今日数据接口</li>
<li>订单总览接口</li>
<li>菜品总览接口</li>
<li>套餐总览接口</li>
<li>订单搜索接口（已完成）</li>
<li>各个状态订单数量接口（已完成）</li>
</ul>
<h5 id="代码导入-2">代码导入</h5>
<h5 id="功能测试-18">功能测试</h5>
<h3 id="Excel-报表统计">Excel 报表统计</h3>
<h4 id="Apache-POI">Apache POI</h4>
<h5 id="介绍-8">介绍</h5>
<p>Apache POI 是一个处理 Microsoft Office 各种文件格式的开源项目。简单来说，我们可以使用 POI 在 Java 程序中对 Microsoft Office 各种文件进行读写操作</p>
<p>一般情况下，POI 用于操作 Excel 文件。</p>
<p>应用场景：</p>
<ul>
<li>银行网银系统导出交易明细</li>
<li>各种业务系统导出 Excel 报表</li>
<li>批量导入业务数据</li>
</ul>
<h5 id="入门案例-7">入门案例</h5>
<ol>
<li>
<p>导入 maven 坐标</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>通过 POI 来向 Excel 文件中写入内容</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过POI创建Excel文件并且写入文件内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">write</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="comment">//在内存中创建一个Excel文件</span></span><br><span class="line">    <span class="type">XSSFWorkbook</span> <span class="variable">excel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XSSFWorkbook</span>();</span><br><span class="line">    <span class="comment">//在Excel文件中创建一个Sheet页</span></span><br><span class="line">    <span class="type">XSSFSheet</span> <span class="variable">sheet</span> <span class="operator">=</span> excel.createSheet(<span class="string">&quot;info&quot;</span>);</span><br><span class="line">    <span class="comment">//在Sheet中创建行对象,rownum编号从0开始</span></span><br><span class="line">    <span class="type">XSSFRow</span> <span class="variable">row</span> <span class="operator">=</span> sheet.createRow(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">//创建单元格并且写入文件内容</span></span><br><span class="line">    row.createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;姓名&quot;</span>);</span><br><span class="line">    row.createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;城市&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建一个新行</span></span><br><span class="line">    row = sheet.createRow(<span class="number">2</span>);</span><br><span class="line">    row.createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line">    row.createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;北京&quot;</span>);</span><br><span class="line"></span><br><span class="line">    row = sheet.createRow(<span class="number">3</span>);</span><br><span class="line">    row.createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;李四&quot;</span>);</span><br><span class="line">    row.createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;南京&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//通过输出流将内存中的Excel文件写入到磁盘</span></span><br><span class="line">    <span class="type">FileOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;D:\\info.xlsx&quot;</span>));</span><br><span class="line">    excel.write(out);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//关闭资源</span></span><br><span class="line">    out.close();</span><br><span class="line">    excel.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>通过 POI 从 Excel 中读取数据</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过POI读取Excel文件中的内容</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">read</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;D:\\info.xlsx&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//读取磁盘上已经存在的Excel文件</span></span><br><span class="line">    <span class="type">XSSFWorkbook</span> <span class="variable">excel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XSSFWorkbook</span>(in);</span><br><span class="line">    <span class="comment">//读取Excel文件中的第一个Sheet页</span></span><br><span class="line">    <span class="type">XSSFSheet</span> <span class="variable">sheet</span> <span class="operator">=</span> excel.getSheetAt(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取Sheet中最后一行的行号</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">lastRowNum</span> <span class="operator">=</span> sheet.getLastRowNum();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= lastRowNum ; i++) &#123;</span><br><span class="line">        <span class="comment">//获得某一行</span></span><br><span class="line">        <span class="type">XSSFRow</span> <span class="variable">row</span> <span class="operator">=</span> sheet.getRow(i);</span><br><span class="line">        <span class="comment">//获得单元格对象</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">cellValue1</span> <span class="operator">=</span> row.getCell(<span class="number">1</span>).getStringCellValue();</span><br><span class="line">        <span class="type">String</span> <span class="variable">cellValue2</span> <span class="operator">=</span> row.getCell(<span class="number">2</span>).getStringCellValue();</span><br><span class="line">        System.out.println(cellValue1 + <span class="string">&quot; &quot;</span> + cellValue2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//关闭资源</span></span><br><span class="line">    in.close();</span><br><span class="line">    excel.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="导出运营数据-Excel-报表">导出运营数据 Excel 报表</h4>
<h5 id="需求分析与设计-11">需求分析与设计</h5>
<p>需求分析</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%AF%BC%E5%87%BAexcel%E6%8A%A5%E8%A1%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90.png" class="">
<p>接口设计：</p>
<img src="/2025/03/02/Web-Development-Sky-Takeout/%E5%AF%BC%E5%87%BAexcel%E6%8A%A5%E8%A1%A8%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1.png" class="">
<h5 id="代码开发-16">代码开发</h5>
<p>实现步骤：</p>
<ol>
<li>设计表格的样板文件（使得在 Java 程序中不需要担心繁琐的表格样式设计，只专注于数据的填充）</li>
<li>查询近 30 天的运营数据</li>
<li>将查询到的数据写入到样板文件中</li>
<li>通过输出流将 Excel 文件输出到浏览器客户端供下载</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">export</span><span class="params">(HttpServletResponse response)</span> &#123;</span><br><span class="line">    InputStream in;</span><br><span class="line">    ServletOutputStream out;</span><br><span class="line">    XSSFWorkbook excel;</span><br><span class="line">    <span class="comment">// 1. 查询数据库，获得营业数据</span></span><br><span class="line">    <span class="comment">// 拿到概览数据</span></span><br><span class="line">    <span class="type">LocalDate</span> <span class="variable">begin</span> <span class="operator">=</span> LocalDate.now().minusDays(<span class="number">30</span>);</span><br><span class="line">    <span class="type">LocalDate</span> <span class="variable">end</span> <span class="operator">=</span> LocalDate.now().minusDays(<span class="number">1</span>);</span><br><span class="line">    <span class="type">BusinessDataVO</span> <span class="variable">businessDataVO</span> <span class="operator">=</span> workspaceService.getBusinessData(LocalDateTime.of(begin, LocalTime.MIN),</span><br><span class="line">            LocalDateTime.of(end, LocalTime.MAX));</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 2. 将营业数据通过POI写入到Excel样板中</span></span><br><span class="line">        in = <span class="built_in">this</span>.getClass().getClassLoader().getResourceAsStream(<span class="string">&quot;template/Excel-Template.xlsx&quot;</span>);</span><br><span class="line">        <span class="comment">// 基于模版文件创建一个workbook</span></span><br><span class="line">        excel = <span class="keyword">new</span> <span class="title class_">XSSFWorkbook</span>(in);</span><br><span class="line">        <span class="comment">//获取表格文件的Sheet页</span></span><br><span class="line">        <span class="type">XSSFSheet</span> <span class="variable">sheet</span> <span class="operator">=</span> excel.getSheet(<span class="string">&quot;Sheet1&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//填充数据--时间</span></span><br><span class="line">        sheet.getRow(<span class="number">1</span>).getCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;时间：&quot;</span> + begin + <span class="string">&quot;至&quot;</span> + end);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获得第4行</span></span><br><span class="line">        <span class="type">XSSFRow</span> <span class="variable">row</span> <span class="operator">=</span> sheet.getRow(<span class="number">3</span>);</span><br><span class="line">        row.getCell(<span class="number">2</span>).setCellValue(businessDataVO.getTurnover());</span><br><span class="line">        row.getCell(<span class="number">4</span>).setCellValue(businessDataVO.getOrderCompletionRate());</span><br><span class="line">        row.getCell(<span class="number">6</span>).setCellValue(businessDataVO.getNewUsers());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获得第5行</span></span><br><span class="line">        row = sheet.getRow(<span class="number">4</span>);</span><br><span class="line">        row.getCell(<span class="number">2</span>).setCellValue(businessDataVO.getValidOrderCount());</span><br><span class="line">        row.getCell(<span class="number">4</span>).setCellValue(businessDataVO.getUnitPrice());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//填充明细数据</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">30</span>; i++) &#123;</span><br><span class="line">            <span class="type">LocalDate</span> <span class="variable">date</span> <span class="operator">=</span> begin.plusDays(i);</span><br><span class="line">            <span class="comment">//查询某一天的营业数据</span></span><br><span class="line">            <span class="type">BusinessDataVO</span> <span class="variable">businessData</span> <span class="operator">=</span> workspaceService.getBusinessData(LocalDateTime.of(date, LocalTime.MIN), LocalDateTime.of(date, LocalTime.MAX));</span><br><span class="line"></span><br><span class="line">            <span class="comment">//获得某一行</span></span><br><span class="line">            row = sheet.getRow(<span class="number">7</span> + i);</span><br><span class="line">            row.getCell(<span class="number">1</span>).setCellValue(date.toString());</span><br><span class="line">            row.getCell(<span class="number">2</span>).setCellValue(businessData.getTurnover());</span><br><span class="line">            row.getCell(<span class="number">3</span>).setCellValue(businessData.getValidOrderCount());</span><br><span class="line">            row.getCell(<span class="number">4</span>).setCellValue(businessData.getOrderCompletionRate());</span><br><span class="line">            row.getCell(<span class="number">5</span>).setCellValue(businessData.getUnitPrice());</span><br><span class="line">            row.getCell(<span class="number">6</span>).setCellValue(businessData.getNewUsers());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. 通过输出流将文件输出到客户端浏览器</span></span><br><span class="line">        out = response.getOutputStream();</span><br><span class="line">        excel.write(out);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. 关闭资源</span></span><br><span class="line">        out.close();</span><br><span class="line">        excel.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="功能测试-19">功能测试</h5>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://FutureYL3.github.io">yl</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://futureyl3.github.io/2025/03/02/Web-Development-Sky-Takeout/">https://futureyl3.github.io/2025/03/02/Web-Development-Sky-Takeout/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web-Development/">Web Development</a><a class="post-meta__tags" href="/tags/Vue/">Vue</a><a class="post-meta__tags" href="/tags/Spring-Boot/">Spring Boot</a><a class="post-meta__tags" href="/tags/Java/">Java</a></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/03/02/Springfox-Swagger/" title="Springfox Swagger"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Springfox Swagger</div></div><div class="info-2"><div class="info-item-1">Introduction to OpenAPI and Swagger using Springfox.</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/03/02/Basic-Web-Development/" title="Basic Web Development -- Java Web"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2025-03-02</div><div class="info-item-2">Basic Web Development -- Java Web</div></div><div class="info-2"><div class="info-item-1">Project oriendted way to get to learn web development, using Java Spring Boot, Vue and MySQL.</div></div></div></a><a class="pagination-related" href="/2025/03/02/JSR-380-Java-Bean-Validation/" title="JSR 380 Java Bean Validation"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2025-03-02</div><div class="info-item-2">JSR 380 Java Bean Validation</div></div><div class="info-2"><div class="info-item-1">Introduce how to add and use "Hibernate-Validator" Bean Validation Framework in Java Spring Boot Web Project.</div></div></div></a><a class="pagination-related" href="/2025/03/02/Java-Learning-Road-Map/" title="Java Learning Road Map"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2025-03-02</div><div class="info-item-2">Java Learning Road Map</div></div><div class="info-2"><div class="info-item-1">Road Map for Java Learner aimed to succeed in web backend development.</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/kano.JPG" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">yl</div><div class="author-info-description">Student at Harbin Institute of Technology (HIT) / Major in Software Engineering</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/FutureYL3" target="_blank" title="My GitHub Profile"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://space.bilibili.com/310715755" target="_blank" title="My Bilibili Space"><i class="fa-brands fa-bilibili" style="color: #00a1d6;"></i></a><a class="social-icon" href="/future_yl@outlook.com" target="_blank" title="My Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">苍穹外卖</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9D%97"><span class="toc-text">基础数据模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%A6%82%E8%BF%B0"><span class="toc-text">项目概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E6%95%B4%E4%BD%93%E4%BB%8B%E7%BB%8D"><span class="toc-text">软件开发整体介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B%EF%BC%88%E4%BB%8E%E4%B8%8A%E8%87%B3%E4%B8%8B%EF%BC%89"><span class="toc-text">软件开发流程（从上至下）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%92%E8%89%B2%E5%88%86%E5%B7%A5"><span class="toc-text">角色分工</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BD%AF%E4%BB%B6%E7%8E%AF%E5%A2%83"><span class="toc-text">软件环境</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D"><span class="toc-text">苍穹外卖项目介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D"><span class="toc-text">项目介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%A7%E5%93%81%E5%8E%9F%E5%9E%8B"><span class="toc-text">产品原型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B"><span class="toc-text">技术选型</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%B1%82%EF%BC%88%E4%B8%BB%E8%A6%81%E6%98%AF%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%EF%BC%89%EF%BC%9A"><span class="toc-text">用户层（主要是前端技术）：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BD%91%E5%85%B3%E5%B1%82%EF%BC%9ANginx"><span class="toc-text">网关层：Nginx</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82%EF%BC%88%E4%B8%BB%E8%A6%81%E6%98%AF%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF%EF%BC%89%EF%BC%9A"><span class="toc-text">应用层（主要是后端技术）：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%B1%82%EF%BC%9A"><span class="toc-text">数据层：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%EF%BC%9A"><span class="toc-text">工具：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">环境搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">开发环境搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">前端环境搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%95%B4%E4%BD%93%E7%BB%93%E6%9E%84"><span class="toc-text">整体结构</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">后端环境搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%EF%BC%9A"><span class="toc-text">项目结构：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%90%84%E6%A8%A1%E5%9D%97%E8%AF%B4%E6%98%8E%EF%BC%9A"><span class="toc-text">项目各模块说明：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#sky-common-%E6%A8%A1%E5%9D%97%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84%EF%BC%9A"><span class="toc-text">sky-common 模块目录结构：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#sky-pojo-%E6%A8%A1%E5%9D%97%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84%EF%BC%9A"><span class="toc-text">sky-pojo 模块目录结构：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#sky-server-%E6%A8%A1%E5%9D%97%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84%EF%BC%9A"><span class="toc-text">sky-server 模块目录结构：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Git-%E8%BF%9B%E8%A1%8C%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6"><span class="toc-text">使用 Git 进行版本控制</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">数据库环境搭建</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%89%8D%E5%90%8E%E7%AB%AF%E8%81%94%E8%B0%83"><span class="toc-text">前后端联调</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%8C%E5%96%84%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD"><span class="toc-text">完善登录功能</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3"><span class="toc-text">导入接口文档</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B"><span class="toc-text">前后端分离开发流程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4"><span class="toc-text">操作步骤</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Swagger"><span class="toc-text">Swagger</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-text">使用方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3"><span class="toc-text">常用注解</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86"><span class="toc-text">员工管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E5%91%98%E5%B7%A5"><span class="toc-text">新增员工</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-text">需求分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="toc-text">功能测试</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%8C%E5%96%84"><span class="toc-text">代码完善</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-text">员工分页查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%AF%E7%94%A8%E7%A6%81%E7%94%A8%E5%91%98%E5%B7%A5%E8%B4%A6%E5%8F%B7"><span class="toc-text">启用禁用员工账号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E5%91%98%E5%B7%A5"><span class="toc-text">编辑员工</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86"><span class="toc-text">分类管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9D%97%E5%8A%9F%E8%83%BD%E4%BB%A3%E7%A0%81"><span class="toc-text">导入分类模块功能代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86"><span class="toc-text">菜品管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AC%E5%85%B1%E5%AD%97%E6%AE%B5%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85"><span class="toc-text">公共字段自动填充</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E8%8F%9C%E5%93%81"><span class="toc-text">新增菜品</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8F%9C%E5%93%81%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-text">菜品分页查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%8F%9C%E5%93%81"><span class="toc-text">删除菜品</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%8F%9C%E5%93%81"><span class="toc-text">修改菜品</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86%E5%AE%9E%E6%88%98"><span class="toc-text">套餐管理实战</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E5%A5%97%E9%A4%90"><span class="toc-text">新增套餐</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E5%A5%97%E9%A4%90"><span class="toc-text">分页查询套餐</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%A5%97%E9%A4%90"><span class="toc-text">删除套餐</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%A5%97%E9%A4%90"><span class="toc-text">修改套餐</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B5%B7%E5%94%AE%E5%81%9C%E5%94%AE%E5%A5%97%E9%A4%90"><span class="toc-text">起售停售套餐</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis"><span class="toc-text">Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Redis-%E5%85%A5%E9%97%A8"><span class="toc-text">Redis 入门</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Redis-%E7%AE%80%E4%BB%8B"><span class="toc-text">Redis 简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Redis-%E4%B8%8B%E8%BD%BD%E4%B8%8E%E5%AE%89%E8%A3%85"><span class="toc-text">Redis 下载与安装</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Redis-%E6%9C%8D%E5%8A%A1%E5%90%AF%E5%8A%A8%E4%B8%8E%E5%81%9C%E6%AD%A2"><span class="toc-text">Redis 服务启动与停止</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redis-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">Redis 数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-%E7%A7%8D%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%BB%8B%E7%BB%8D"><span class="toc-text">5 种常用数据类型介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-text">各种数据类型的特点</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redis-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">Redis 常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4"><span class="toc-text">字符串操作命令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%93%88%E5%B8%8C%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4"><span class="toc-text">哈希操作命令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4"><span class="toc-text">列表操作命令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4"><span class="toc-text">集合操作命令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4"><span class="toc-text">有序集合操作命令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">通用命令</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8-Java-%E4%B8%AD%E6%93%8D%E4%BD%9C-Redis"><span class="toc-text">在 Java 中操作 Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Redis-%E7%9A%84-Java-%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">Redis 的 Java 客户端</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Spring-Data-Redis-%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-text">Spring Data Redis 使用方式</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="toc-text">步骤：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C"><span class="toc-text">字符串操作</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%93%88%E5%B8%8C%E6%93%8D%E4%BD%9C"><span class="toc-text">哈希操作</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="toc-text">列表操作</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C"><span class="toc-text">集合操作</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88"><span class="toc-text">有序集合</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E5%91%BD%E4%BB%A4-2"><span class="toc-text">通用命令</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%82%B9%E9%A4%90%E4%B8%9A%E5%8A%A1%E6%A8%A1%E5%9D%97"><span class="toc-text">点餐业务模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%97%E9%93%BA%E8%90%A5%E4%B8%9A%E7%8A%B6%E6%80%81%E8%AE%BE%E7%BD%AE"><span class="toc-text">店铺营业状态设置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1"><span class="toc-text">需求分析和设计</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-2"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-2"><span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95"><span class="toc-text">微信登录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HttpClient"><span class="toc-text">HttpClient</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-2"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B"><span class="toc-text">入门案例</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#GET-%E8%AF%B7%E6%B1%82"><span class="toc-text">GET 请求</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#POST-%E8%AF%B7%E6%B1%82"><span class="toc-text">POST 请求</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E4%B8%AD%E6%8F%90%E4%BE%9B%E7%9A%84%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-text">代码中提供的工具类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91"><span class="toc-text">微信小程序开发</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-3"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-text">准备工作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B-2"><span class="toc-text">入门案例</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-text">目录结构</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81"><span class="toc-text">导入小程序代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95-2"><span class="toc-text">微信登录</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E6%B5%81%E7%A8%8B"><span class="toc-text">微信登录流程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1"><span class="toc-text">需求分析与设计</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-3"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-3"><span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97"><span class="toc-text">导入商品浏览功能模块</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1-2"><span class="toc-text">需求分析与设计</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1"><span class="toc-text">接口设计</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-4"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-4"><span class="toc-text">功能测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81"><span class="toc-text">缓存商品</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%93%E5%AD%98%E8%8F%9C%E5%93%81"><span class="toc-text">缓存菜品</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E8%AF%B4%E6%98%8E"><span class="toc-text">问题说明</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF"><span class="toc-text">实现思路</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-5"><span class="toc-text">代码开发</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%97%B6%E6%B7%BB%E5%8A%A0%E7%BC%93%E5%AD%98"><span class="toc-text">查询时添加缓存</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%97%B6%E6%B8%85%E7%90%86%E7%BC%93%E5%AD%98"><span class="toc-text">修改时清理缓存</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-5"><span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%93%E5%AD%98%E5%A5%97%E9%A4%90"><span class="toc-text">缓存套餐</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SpringCache"><span class="toc-text">SpringCache</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-4"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3-2"><span class="toc-text">常用注解</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B-3"><span class="toc-text">入门案例</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF-2"><span class="toc-text">实现思路</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-6"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-6"><span class="toc-text">功能测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="toc-text">购物车</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%88%B0%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="toc-text">添加到购物车</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1-2"><span class="toc-text">需求分析和设计</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-7"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-7"><span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="toc-text">查看购物车</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B8%85%E7%A9%BA%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="toc-text">清空购物车</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95"><span class="toc-text">用户下单</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E5%9C%B0%E5%9D%80%E8%96%84%E5%8A%9F%E8%83%BD%E4%BB%A3%E7%A0%81"><span class="toc-text">导入地址薄功能代码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1-3"><span class="toc-text">需求分析和设计</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E4%BB%A3%E7%A0%81"><span class="toc-text">导入代码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-8"><span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95-2"><span class="toc-text">用户下单</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1-3"><span class="toc-text">需求分析与设计</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E4%B8%9A%E5%8A%A1%E8%AF%B4%E6%98%8E%EF%BC%9A"><span class="toc-text">用户下单业务说明：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E5%90%8E%E4%BC%9A%E4%BA%A7%E7%94%9F%E8%AE%A2%E5%8D%95%E7%9B%B8%E5%85%B3%E6%95%B0%E6%8D%AE%EF%BC%8C%E8%AE%A2%E5%8D%95%E6%95%B0%E6%8D%AE%E9%9C%80%E8%A6%81%E8%83%BD%E5%A4%9F%E4%BD%93%E7%8E%B0%E5%A6%82%E4%B8%8B%E4%BF%A1%E6%81%AF%EF%BC%9A"><span class="toc-text">用户下单后会产生订单相关数据，订单数据需要能够体现如下信息：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%82%B9%E9%A4%90%E4%B8%9A%E5%8A%A1%E6%B5%81%E7%A8%8B%EF%BC%9A"><span class="toc-text">用户点餐业务流程：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E5%88%86%E6%9E%90%EF%BC%9A"><span class="toc-text">接口分析：</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-8"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-9"><span class="toc-text">功能测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98%E5%92%8C%E7%AE%A1%E7%90%86"><span class="toc-text">订单支付和管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E4%BB%8B%E7%BB%8D"><span class="toc-text">微信支付介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E4%BA%A7%E5%93%81%EF%BC%9A"><span class="toc-text">微信支付产品：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E6%8E%A5%E5%85%A5%E6%B5%81%E7%A8%8B%EF%BC%9A"><span class="toc-text">小程序微信支付接入流程：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%94%AF%E4%BB%98%E6%97%B6%E5%BA%8F%E5%9B%BE%EF%BC%9A"><span class="toc-text">微信小程序支付时序图：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E4%B8%8B%E5%8D%95%E6%8E%A5%E5%8F%A3%EF%BC%9A"><span class="toc-text">请求下单接口：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E9%98%B6%E6%AE%B5%EF%BC%9A"><span class="toc-text">关键阶段：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#JSAPI-%E4%B8%8B%E5%8D%95%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E"><span class="toc-text">JSAPI 下单详细说明</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%B0%83%E8%B5%B7%E6%94%AF%E4%BB%98"><span class="toc-text">微信小程序调起支付</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-text">微信支付准备工作</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%EF%BC%9F"><span class="toc-text">调用过程如何保证数据安全？</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E5%90%8E%E5%8F%B0%E5%A6%82%E4%BD%95%E8%B0%83%E7%94%A8%E5%88%B0%E5%95%86%E6%88%B7%E7%B3%BB%E7%BB%9F%EF%BC%9F"><span class="toc-text">微信后台如何调用到商户系统？</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AF%BC%E5%85%A5"><span class="toc-text">代码导入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-10"><span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95"><span class="toc-text">历史订单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86"><span class="toc-text">订单状态定时处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Spring-Task"><span class="toc-text">Spring Task</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-5"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#cron-%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text">cron 表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B-4"><span class="toc-text">入门案例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86-2"><span class="toc-text">订单状态定时处理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-2"><span class="toc-text">需求分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-9"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-11"><span class="toc-text">功能测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95"><span class="toc-text">来单提醒和客户催单</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSocket"><span class="toc-text">WebSocket</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-6"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B-5"><span class="toc-text">入门案例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92"><span class="toc-text">来单提醒</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1-4"><span class="toc-text">需求分析与设计</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-10"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-12"><span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95"><span class="toc-text">客户催单</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1-5"><span class="toc-text">需求分析与设计</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-11"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-13"><span class="toc-text">功能测试</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E6%8A%A5%E8%A1%A8%E6%A8%A1%E5%9D%97"><span class="toc-text">统计报表模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8%E8%AE%BE%E8%AE%A1"><span class="toc-text">图形报表设计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Apache-EChatrs"><span class="toc-text">Apache EChatrs</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-7"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B-6"><span class="toc-text">入门案例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%90%A5%E4%B8%9A%E9%A2%9D%E7%BB%9F%E8%AE%A1"><span class="toc-text">营业额统计</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1-6"><span class="toc-text">需求分析与设计</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-12"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-14"><span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%BB%9F%E8%AE%A1"><span class="toc-text">用户统计</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1-7"><span class="toc-text">需求分析与设计</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-13"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-15"><span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E7%BB%9F%E8%AE%A1"><span class="toc-text">订单统计</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1-8"><span class="toc-text">需求分析与设计</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-14"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-16"><span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%94%80%E9%87%8F%E6%8E%92%E5%90%8D-top10"><span class="toc-text">销量排名 top10</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1-9"><span class="toc-text">需求分析与设计</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-15"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-17"><span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E5%8F%B0%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0"><span class="toc-text">工作台设计与实现</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1-10"><span class="toc-text">需求分析与设计</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AF%BC%E5%85%A5-2"><span class="toc-text">代码导入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-18"><span class="toc-text">功能测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Excel-%E6%8A%A5%E8%A1%A8%E7%BB%9F%E8%AE%A1"><span class="toc-text">Excel 报表统计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Apache-POI"><span class="toc-text">Apache POI</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-8"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B-7"><span class="toc-text">入门案例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA%E8%BF%90%E8%90%A5%E6%95%B0%E6%8D%AE-Excel-%E6%8A%A5%E8%A1%A8"><span class="toc-text">导出运营数据 Excel 报表</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1-11"><span class="toc-text">需求分析与设计</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-16"><span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-19"><span class="toc-text">功能测试</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/02/Web-Development-Sky-Takeout/" title="Web Development -- Sky Takeout">Web Development -- Sky Takeout</a><time datetime="2025-03-02T10:51:57.000Z" title="Created 2025-03-02 18:51:57">2025-03-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/02/Springfox-Swagger/" title="Springfox Swagger">Springfox Swagger</a><time datetime="2025-03-02T10:42:33.000Z" title="Created 2025-03-02 18:42:33">2025-03-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/02/Database-and-SQL-Basic-Concepts-and-Usage/" title="Database and SQL: Basic Concepts and Usage">Database and SQL: Basic Concepts and Usage</a><time datetime="2025-03-02T10:29:51.000Z" title="Created 2025-03-02 18:29:51">2025-03-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/02/MyBatis-Plus-Basic-Usage/" title="MyBatis Plus Basic Usage">MyBatis Plus Basic Usage</a><time datetime="2025-03-02T10:19:09.000Z" title="Created 2025-03-02 18:19:09">2025-03-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/02/MIT-The-Missing-Semester-Lec10-Potpourri/" title="[MIT The Missing Semester] Lec10: Potpourri">[MIT The Missing Semester] Lec10: Potpourri</a><time datetime="2025-03-02T10:10:46.000Z" title="Created 2025-03-02 18:10:46">2025-03-02</time></div></div></div></div></div></div></main><footer id="footer" style="background: linear-gradient(to right, rgb(198, 255, 221), rgb(251, 215, 134), rgb(247, 121, 125));"><div id="footer-wrap"><div class="copyright">&copy;2025 By yl</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.3</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><div class="js-pjax"><script>(async () => {
  const showKatex = () => {
    document.querySelectorAll('#article-container .katex').forEach(el => el.classList.add('katex-show'))
  }

  if (!window.katex_js_css) {
    window.katex_js_css = true
    await btf.getCSS('https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css')
    if (true) {
      await btf.getScript('https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js')
    }
  }

  showKatex()
})()</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const applyThemeDefaultsConfig = theme => {
    if (theme === 'dark-mode') {
      Chart.defaults.color = "rgba(255, 255, 255, 0.8)"
      Chart.defaults.borderColor = "rgba(255, 255, 255, 0.2)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    } else {
      Chart.defaults.color = "rgba(0, 0, 0, 0.8)"
      Chart.defaults.borderColor = "rgba(0, 0, 0, 0.1)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    }
  }

  // Recursively traverse the config object and automatically apply theme-specific color schemes
  const applyThemeConfig = (obj, theme) => {
    if (typeof obj !== 'object' || obj === null) return

    Object.keys(obj).forEach(key => {
      const value = obj[key]
      // If the property is an object and has theme-specific options, apply them
      if (typeof value === 'object' && value !== null) {
        if (value[theme]) {
          obj[key] = value[theme] // Apply the value for the current theme
        } else {
          // Recursively process child objects
          applyThemeConfig(value, theme)
        }
      }
    })
  }

  const runChartJS = ele => {
    window.loadChartJS = true

    Array.from(ele).forEach((item, index) => {
      const chartSrc = item.firstElementChild
      const chartID = item.getAttribute('data-chartjs-id') || ('chartjs-' + index) // Use custom ID or default ID
      const width = item.getAttribute('data-width')
      const existingCanvas = document.getElementById(chartID)

      // If a canvas already exists, remove it to avoid rendering duplicates
      if (existingCanvas) {
          existingCanvas.parentNode.remove()
      }

      const chartDefinition = chartSrc.textContent
      const canvas = document.createElement('canvas')
      canvas.id = chartID

      const div = document.createElement('div')
      div.className = 'chartjs-wrap'

      if (width) {
        div.style.width = width
      }

      div.appendChild(canvas)
      chartSrc.insertAdjacentElement('afterend', div)

      const ctx = document.getElementById(chartID).getContext('2d')

      const config = JSON.parse(chartDefinition)

      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark-mode' : 'light-mode'

      // Set default styles (initial setup)
      applyThemeDefaultsConfig(theme)

      // Automatically traverse the config and apply dual-mode color schemes
      applyThemeConfig(config, theme)

      new Chart(ctx, config)
    })
  }

  const loadChartJS = () => {
    const chartJSEle = document.querySelectorAll('#article-container .chartjs-container')
    if (chartJSEle.length === 0) return

    window.loadChartJS ? runChartJS(chartJSEle) : btf.getScript('https://cdn.jsdelivr.net/npm/chart.js/dist/chart.umd.min.js').then(() => runChartJS(chartJSEle))
  }

  // Listen for theme change events
  btf.addGlobalFn('themeChange', loadChartJS, 'chartjs')
  btf.addGlobalFn('encrypt', loadChartJS, 'chartjs')

  window.pjax ? loadChartJS() : document.addEventListener('DOMContentLoaded', loadChartJS)
})()</script></div><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      window.location.href = e.request.responseURL
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="search through all posts and pages" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>